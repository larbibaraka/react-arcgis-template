(function(){(this||window).webpackJsonp.registerAbsMids({"esri/layers/graphics/data/QueryEngineCapabilities":294,"esri/layers/graphics/sources/support/MemorySourceWorker":2365,"esri/layers/graphics/sources/support/sourceUtils":2366})})(),(window.webpackJsonp=window.webpackJsonp||[]).push([[103],{2365:function(e,t,i){var r,n;r=[i.dj.c(e.i),t,i(31),i(32),i(35),i(36),i(34),i(46),i(63),i(157),i(267),i(163),i(229),i(581),i(2366),i(148),i(170),i(65)],void 0===(n=function(e,t,i,r,n,s,a,u,o,l,d,p,c,f,y,h,m,g){function v(e){return u.isPoint(e)?null!=e.z:!!e.hasZ}function b(e){return u.isPoint(e)?null!=e.m:!!e.hasM}Object.defineProperty(t,"__esModule",{value:!0});var F=o.WGS84,I={xmin:-180,ymin:-90,xmax:180,ymax:90,spatialReference:o.WGS84},E={hasAttachments:!1,capabilities:"query, editing, create, delete, update",useStandardizedQueries:!0,supportsCoordinatesQuantization:!0,supportsReturningQueryGeometry:!0,advancedQueryCapabilities:{supportsQueryAttachments:!1,supportsStatistics:!0,supportsReturningGeometryCentroid:!0,supportsQueryWithDistance:!0,supportsDistinct:!0,supportsReturningQueryExtent:!0,supportsReturningGeometryProperties:!1,supportsHavingClause:!0,supportsOrderBy:!0,supportsPagination:!0,supportsQueryWithResultType:!1,supportsSqlExpression:!0,supportsDisjointSpatialRel:!0}},_=function(){function e(){this._queryEngine=null,this._nextObjectId=null}return e.prototype.destroy=function(){this._queryEngine&&this._queryEngine&&this._queryEngine.destroy(),this._queryEngine=this._requiredFields=this._fieldsIndex=this._createDefaultAttributes=null},e.prototype.load=function(e){return r(this,void 0,void 0,function(){var t,r,a,u,o,l,y,v,b,_,j,x,R,T,w,q,S,D,O,M,P,Q,C,k,A;return i(this,function(i){switch(i.label){case 0:if(t=[],r=e.features,a=this._inferLayerProperties(r,e.fields),u=e.fields||[],o=null!=e.hasM?e.hasM:a.hasM,l=null!=e.hasZ?e.hasZ:a.hasZ,y=!e.spatialReference&&!a.spatialReference,v=y?F:e.spatialReference||a.spatialReference,b=y?I:null,_=e.geometryType||a.geometryType,j=e.objectIdField||a.objectIdField,x=e.timeInfo,y&&t.push({name:"feature-layer:spatial-reference-not-found",message:"Spatial reference not provided or found in features. Defaults to WGS84"}),!_)throw new s("feature-layer:missing-property","geometryType not set and couldn't be inferred from the provided features");if(!j)throw new s("feature-layer:missing-property","objectIdField not set and couldn't be found in the provided fields");for(a.objectIdField&&j!==a.objectIdField&&(t.push({name:"feature-layer:duplicated-oid-field",message:'Provided objectIdField "'+j+'" doesn\'t match the field name "'+a.objectIdField+'", found in the provided fields'}),j=a.objectIdField),j&&!a.objectIdField&&(R=null,u.some(function(e){return e.name===j&&(R=e,!0)})?(R.type="esriFieldTypeOID",R.editable=!1,R.nullable=!1):u.unshift({alias:j,name:j,type:"esriFieldTypeOID",editable:!1,nullable:!1})),T=0,w=u;T<w.length;T++){if(null==(O=w[T]).name&&(O.name=O.alias),null==O.alias&&(O.alias=O.name),!O.name)throw new s("feature-layer:invalid-field-name","field name is missing",{field:O});if(O.name===j&&(O.type="esriFieldTypeOID"),-1===m.kebabDict.jsonValues.indexOf(O.type))throw new s("feature-layer:invalid-field-type",'invalid type for field "'+O.name+'"',{field:O})}for(q={},this._requiredFields=[],S=0,D=u;S<D.length;S++)"esriFieldTypeOID"!==(O=D[S]).type&&"esriFieldTypeGlobalID"!==O.type&&(O.editable=null==O.editable||!!O.editable,O.nullable=null==O.nullable||!!O.nullable,M=g.getFieldDefaultValue(O),O.nullable||void 0!==M?q[O.name]=M:this._requiredFields.push(O));return this._fieldsIndex=new h(u),this._createDefaultAttributes=f.createDefaultAttributesFunction(q,j),x&&(x.startTimeField&&((P=this._fieldsIndex.get(x.startTimeField))?(x.startTimeField=P.name,P.type="esriFieldTypeDate"):x.startTimeField=null),x.endTimeField&&((Q=this._fieldsIndex.get(x.endTimeField))?(x.endTimeField=Q.name,Q.type="esriFieldTypeDate"):x.endTimeField=null),x.trackIdField&&((C=this._fieldsIndex.get(x.trackIdField))?x.trackIdField=C.name:(x.trackIdField=null,t.push({name:"feature-layer:invalid-timeInfo-trackIdField",message:"trackIdField is missing",details:{timeInfo:x}}))),x.startTimeField||x.endTimeField||(t.push({name:"feature-layer:invalid-timeInfo",message:"startTimeField and endTimeField are missing or invalid",details:{timeInfo:x}}),x=null)),k={warnings:t,featureErrors:[],layerDefinition:n({},E,{drawingInfo:f.createDrawingInfo(_),templates:f.createDefaultTemplate(q),extent:b,geometryType:_,objectIdField:j,fields:u,hasZ:!!l,hasM:!!o,timeInfo:x}),assignedObjectIds:{}},this._queryEngine=new c.default({fields:u,geometryType:_,hasM:o,hasZ:l,objectIdField:j,spatialReference:v,featureStore:new d.default({geometryType:_,hasM:o,hasZ:l}),timeInfo:x}),r&&r.length?(A=r.reduce(function(e,t){var i=t.attributes&&t.attributes[j];return null==i||isNaN(i)||!isFinite(i)?e:Math.max(e,i)},0),this._nextObjectId=1+A,[4,p.checkProjectionSupport(r,v)]):(this._nextObjectId=1,[2,k]);case 1:return i.sent(),[2,this._loadInitialFeatures(k,r)]}})})},e.prototype.applyEdits=function(e){return r(this,void 0,void 0,function(){var t,r,n;return i(this,function(i){switch(i.label){case 0:return t=this._queryEngine,r=t.spatialReference,n=t.geometryType,[4,a.all([y.loadGeometryEngineForSimplify(n),p.checkProjectionSupport(e.adds,r),p.checkProjectionSupport(e.updates,r)])];case 1:return i.sent(),[2,this._applyEdits(e)]}})})},e.prototype.queryFeatures=function(e,t){return void 0===t&&(t={}),r(this,void 0,void 0,function(){return i(this,function(i){return[2,this._queryEngine.executeQuery(e,t.signal)]})})},e.prototype.queryFeatureCount=function(e,t){return void 0===t&&(t={}),r(this,void 0,void 0,function(){return i(this,function(i){return[2,this._queryEngine.executeQueryForCount(e,t.signal)]})})},e.prototype.queryObjectIds=function(e,t){return void 0===t&&(t={}),r(this,void 0,void 0,function(){return i(this,function(i){return[2,this._queryEngine.executeQueryForIds(e,t.signal)]})})},e.prototype.queryExtent=function(e,t){return void 0===t&&(t={}),r(this,void 0,void 0,function(){return i(this,function(i){return[2,this._queryEngine.executeQueryForExtent(e,t.signal)]})})},e.prototype._inferLayerProperties=function(e,t){for(var i=void 0,r=void 0,n=null,s=null,a=null,o=0,l=e;o<l.length;o++){var d=l[o].geometry;if(d&&(n||(n=u.getJsonType(d)),s||(s=d.spatialReference),null==i&&(i=v(d)),null==r&&(r=b(d)),n&&s&&null!=i&&null!=r))break}if(t&&t.length){var p=null;t.some(function(e){var t="esriFieldTypeOID"===e.type,i=!e.type&&e.name&&"objectid"===e.name.toLowerCase();return p=e,t||i})&&(a=p.name)}return{geometryType:n,spatialReference:s,objectIdField:a,hasM:r,hasZ:i}},e.prototype._loadInitialFeatures=function(e,t){for(var i=this._queryEngine,r=i.geometryType,n=i.hasM,s=i.hasZ,a=i.objectIdField,o=i.spatialReference,d=i.featureStore,c=[],f=0,h=t;f<h.length;f++){var m=h[f];if(null!=m.uid&&(e.assignedObjectIds[m.uid]=-1),m.geometry&&r!==u.getJsonType(m.geometry))e.featureErrors.push(y.createFeatureEditErrorResult("Incorrect geometry type."));else{var g=this._createDefaultAttributes(),v=y.mixAttributes(this._fieldsIndex,this._requiredFields,g,m.attributes,!0,e.warnings);v?e.featureErrors.push(v):(this._assignObjectId(g,m.attributes,!0),m.attributes=g,null!=m.uid&&(e.assignedObjectIds[m.uid]=m.attributes[a]),m.geometry&&(m.geometry=p.project(m.geometry,m.geometry.spatialReference,o)),c.push(m))}}if(d.addMany(l.convertFromFeatures([],c,r,s,n,a)),e.layerDefinition.extent=this._queryEngine.fullExtent,e.layerDefinition.timeInfo){var b=this._queryEngine.timeExtent,F=b.start,I=b.end;e.layerDefinition.timeInfo.timeExtent=[F,I]}return e},e.prototype._applyEdits=function(e){var t=e.adds,i=e.updates,r=e.deletes,n={addResults:[],deleteResults:[],updateResults:[],uidToObjectId:{}};if(t&&t.length&&this._applyAddEdits(n,t),i&&i.length&&this._applyUpdateEdits(n,i),r&&r.length){for(var s=0,a=r;s<a.length;s++){var u=a[s];n.deleteResults.push(y.createFeatureEditSuccessResult(u))}this._queryEngine.featureStore.removeManyById(r)}return{fullExtent:this._queryEngine.fullExtent,featureEditResults:n}},e.prototype._applyAddEdits=function(e,t){for(var i=e.addResults,r=this._queryEngine,n=r.geometryType,s=r.hasM,a=r.hasZ,o=r.objectIdField,d=r.spatialReference,c=r.featureStore,f=[],h=0,m=t;h<m.length;h++){var g=m[h];if(g.geometry&&n!==u.getJsonType(g.geometry))i.push(y.createFeatureEditErrorResult("Incorrect geometry type."));else{var v=this._createDefaultAttributes(),b=y.mixAttributes(this._fieldsIndex,this._requiredFields,v,g.attributes);if(b)i.push(b);else{if(this._assignObjectId(v,g.attributes),g.attributes=v,null!=g.uid){var F=g.attributes[o];e.uidToObjectId[g.uid]=F}g.geometry&&(g.geometry=p.project(y.simplify(g.geometry,d),g.geometry.spatialReference,d)),f.push(g),i.push(y.createFeatureEditSuccessResult(g.attributes[o]))}}}c.addMany(l.convertFromFeatures([],f,n,a,s,o))},e.prototype._applyUpdateEdits=function(e,t){for(var i=e.updateResults,r=this._queryEngine,n=r.geometryType,s=r.hasM,a=r.hasZ,o=r.objectIdField,d=r.spatialReference,c=r.featureStore,f=0,h=t;f<h.length;f++){var m=h[f],g=m.attributes,v=m.geometry,b=g&&g[o];if(null!=b)if(c.has(b)){var F=l.convertToFeature(c.getFeature(b),n,a,s);if(v){if(n!==u.getJsonType(v)){i.push(y.createFeatureEditErrorResult("Incorrect geometry type."));continue}F.geometry=p.project(y.simplify(v,d),v.spatialReference,d)}if(g){var I=y.mixAttributes(this._fieldsIndex,this._requiredFields,F.attributes,g);if(I){i.push(I);continue}}c.add(l.convertFromFeature(F,n,a,s,o)),i.push(y.createFeatureEditSuccessResult(b))}else i.push(y.createFeatureEditErrorResult("Feature with object id "+b+" missing"));else i.push(y.createFeatureEditErrorResult("Identifier field "+o+" missing"))}},e.prototype._assignObjectId=function(e,t,i){void 0===i&&(i=!1);var r=this._queryEngine.objectIdField;i&&t&&isFinite(t[r])?e[r]=t[r]:e[r]=this._nextObjectId++},e}();t.default=_}.apply(null,r))||(e.exports=n)},2366:function(e,t,i){var r,n;r=[i.dj.c(e.i),t,i(31),i(32),i(65),i(6)],void 0===(n=function(e,t,r,n,s){function a(e){return new d(e)}function u(e,t){var i=t;return"string"==typeof t&&s.isNumericField(e)?i=parseFloat(t):null!=t&&s.isStringField(e)&&"string"!=typeof t&&(i=String(t)),s.sanitizeNullFieldValue(i)}function o(){return n(this,void 0,void 0,function(){return r(this,function(e){switch(e.label){case 0:return c?[2,c]:[4,new Promise(function(e,t){i.e(7).then(function(){var t=[i(255)];e.apply(null,t)}.bind(this)).catch(t.bind(this))})];case 1:return[2,c=e.sent()]}})})}Object.defineProperty(t,"__esModule",{value:!0});var l=function(){return function(){this.code=null,this.description=null}}(),d=function(){return function(e){this.error=new l,this.globalId=null,this.objectId=null,this.success=!1,this.uniqueId=null,this.error.description=e}}();t.createFeatureEditErrorResult=a;var p=function(){return function(e){this.globalId=null,this.success=!0,this.objectId=this.uniqueId=e}}();t.createFeatureEditSuccessResult=function(e){return new p(e)};var c,f=new Set;t.mixAttributes=function(e,t,i,r,n,o){for(var l in void 0===n&&(n=!1),f.clear(),r){var d=e.get(l);if(d){var p=r[l],c=u(d,p);if(c!==p&&o&&o.push({name:"invalid-value-type",message:"attribute value was converted to match the field type",details:{field:d,originalValue:p,sanitizedValue:c}}),f.add(d.name),d&&(n||d.editable)){var y=s.validateFieldValue(d,c);if(y)return a(s.validationErrorToString(y,d,c));i[d.name]=c}}}for(var h=0,m=t;h<m.length;h++){var g=m[h];if(!f.has(g.name))return a('missing required field "'+g.name+'"')}return null},t.simplify=function(e,t){if(!e)return e;if("rings"in e||"paths"in e){if(!c)throw new TypeError("geometry engine not loaded");e.spatialReference||(e.spatialReference=t);var i=c.simplify(e);return i?i.toJSON():null}return e},t.loadGeometryEngine=o,t.loadGeometryEngineForSimplify=function(e){return n(this,void 0,void 0,function(){return r(this,function(t){switch(t.label){case 0:return"esriGeometryPolygon"!==e&&"esriGeometryPolyline"!==e?[3,2]:[4,o()];case 1:t.sent(),t.label=2;case 2:return[2]}})})}}.apply(null,r))||(e.exports=n)},294:function(e,t,i){var r,n;r=[i.dj.c(e.i),t],void 0===(n=function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.queryCapabilities={supportsStatistics:!0,supportsCentroid:!0,supportsCacheHint:!1,supportsDistance:!0,supportsDistinct:!0,supportsExtent:!0,supportsGeometryProperties:!1,supportsHavingClause:!0,supportsOrderBy:!0,supportsPagination:!0,supportsQuantization:!0,supportsQuantizationEditMode:!1,supportsQueryGeometry:!0,supportsResultType:!1,supportsSqlExpression:!0,supportsMaxRecordCountFactor:!1,supportsStandardizedQueriesOnly:!0,supportsQueryByOthers:!0,supportsHistoricMoment:!1,supportsFormatPBF:!1,supportsDisjointSpatialRelationship:!0,maxRecordCountFactor:void 0,maxRecordCount:void 0,standardMaxRecordCount:void 0,tileMaxRecordCount:void 0}}.apply(null,r))||(e.exports=n)}}]);