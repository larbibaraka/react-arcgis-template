(function(){(this||window).webpackJsonp.registerAbsMids({"esri/tasks/support/Query":74,"esri/layers/support/Field":78,"esri/tasks/support/StatisticDefinition":93,"esri/tasks/operations/urlUtils":117,"esri/layers/support/FieldsIndex":148,"esri/core/requireUtils":164,"esri/tasks/operations/query":171,"esri/layers/graphics/data/QueryEngineCapabilities":294,"esri/geohash/geohashUtils":394,"esri/views/2d/layers/features/controllers/BaseController":624,"esri/views/2d/layers/features/support/ClusterStore":625,"esri/geohash/GeohashTree":626,"esri/views/2d/layers/features/support/pixelBuffering":627,"esri/views/2d/layers/features/controllers/OnDemandController":2282,"esri/views/2d/layers/features/controllers/EditsQueue":2283,"esri/views/2d/layers/features/support/DataTile":2284,"esri/views/2d/layers/features/support/DataTileFeaturesIndex":2285,"esri/core/SetPool":2286,"esri/views/2d/layers/features/support/TileUpdateQueue":2287})})(),(window.webpackJsonp=window.webpackJsonp||[]).push([[49,107],{117:function(e,t,r){var i,o;i=[r.dj.c(e.i),t],void 0===(o=function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.mapParameters=function e(t){var r={};for(var i in t)if("declaredClass"!==i){var o=t[i];if(null!=o&&"function"!=typeof o)if(Array.isArray(o)){r[i]=[];for(var n=0;n<o.length;n++)r[i][n]=e(o[n])}else"object"==typeof o?o.toJSON&&(r[i]=JSON.stringify(o)):r[i]=o}return r}}.apply(null,i))||(e.exports=o)},148:function(e,t,r){var i,o;i=[r.dj.c(e.i),t,r(43)],void 0===(o=function(e,t,r){function i(e){return"date"===e.type||"esriFieldTypeDate"===e.type}function o(e){return e.toLowerCase().trim()}return function(){function e(e){if(this.fields=e,this._fieldsMap=new Map,this._dateFieldsSet=new Set,this.dateFields=[],e){for(var t=[],r=0,n=e;r<n.length;r++){var s=n[r],a=s&&s.name;if(a){var u=o(a);this._fieldsMap.set(a,s),this._fieldsMap.set(u,s),t.push(u),i(s)&&(this.dateFields.push(s),this._dateFieldsSet.add(s))}}t.sort(),this.uid=t.join(",")}}return e.prototype.destroy=function(){this._fieldsMap.clear()},e.prototype.has=function(e){return null!=this.get(e)},e.prototype.get=function(e){return null!=e?this._fieldsMap.get(e)||this._fieldsMap.get(o(e)):void 0},e.prototype.isDateField=function(e){return this._dateFieldsSet.has(this.get(e))},e.prototype.normalizeFieldName=function(e){var t=this.get(e);if(t)return t.name},e}()}.apply(null,i))||(e.exports=o)},164:function(e,t,r){var i,o;i=[r.dj.c(e.i),t,r(187),r(37),r(34)],void 0===(o=function(e,t,r,i,o){Object.defineProperty(t,"__esModule",{value:!0});var n=i.getLogger("esri.core.requireUtils");t.when=function e(t,i){return r.deprecatedFunction(n,"when",{moduleName:"requireUtils",replacement:"Use `promiseUtils.create()` instead.",version:"4.10",warnOnce:!0}),Array.isArray(i)?o.create(function(e){t(i,function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];e(t)})}):e(t,[i]).then(function(e){return e[0]})},t.getAbsMid=function(e,t,r){return t.toAbsMid?t.toAbsMid(e):r.id.replace(/\/[^\/]*$/gi,"/")+e}}.apply(null,i))||(e.exports=o)},171:function(e,t,r){var i,o;i=[r.dj.c(e.i),t,r(35),r(44),r(40),r(39),r(46),r(104),r(228),r(227),r(117),r(6)],void 0===(o=function(e,t,r,i,o,n,s,a,u,l,c){function d(e,t){var r=e.geometry,i=e.toJSON(),o=i;if(r&&(o.geometry=JSON.stringify(r),o.geometryType=s.getJsonType(r),o.inSR=r.spatialReference.wkid||JSON.stringify(r.spatialReference)),i.groupByFieldsForStatistics&&(o.groupByFieldsForStatistics=i.groupByFieldsForStatistics.join(",")),i.objectIds&&(o.objectIds=i.objectIds.join(",")),i.orderByFields&&(o.orderByFields=i.orderByFields.join(",")),!i.outFields||t&&(t.returnCountOnly||t.returnExtentOnly||t.returnIdsOnly)?delete o.outFields:-1!==i.outFields.indexOf("*")?o.outFields="*":o.outFields=i.outFields.join(","),i.outSR?o.outSR=i.outSR.wkid||JSON.stringify(i.outSR):r&&(i.returnGeometry||i.returnCentroid)&&(o.outSR=o.inSR),i.returnGeometry&&delete i.returnGeometry,i.outStatistics&&(o.outStatistics=JSON.stringify(i.outStatistics)),i.pixelSize&&(o.pixelSize=JSON.stringify(i.pixelSize)),i.quantizationParameters&&(o.quantizationParameters=JSON.stringify(i.quantizationParameters)),i.source&&(o.layer=JSON.stringify({source:i.source}),delete i.source),i.timeExtent){var n=i.timeExtent,a=n.start,u=n.end;null==a&&null==u||(o.time=a===u?a:(null==a?"null":a)+","+(null==u?"null":u)),delete i.timeExtent}return o}function p(e,t,s,u,l){void 0===u&&(u={});var p="string"==typeof e?n.urlToObject(e):e,h=t.geometry?[t.geometry]:[];return u.responseType="pbf"===s?"array-buffer":"json",a.normalizeCentralMeridian(h,null,u).then(function(e){var n=e&&e[0];o.isSome(n)&&((t=t.clone()).geometry=n);var a=c.mapParameters(r({},p.query,{f:s},l,d(t,l)));return i(p.path+"/query",r({},u,{query:a}))})}Object.defineProperty(t,"__esModule",{value:!0});var h,f="Layer does not support extent calculation.";t.queryToQueryStringParameters=d,t.executeQuery=function(e,t,r){return p(e,t,"json",r)},t.executeQueryPBF=function(e,t,r,i){var o=r.useWorker?(null==h&&(h=new l.PBFWorker),h):null;return p(e,t,"pbf",i).then(function(e){var t=function(t){var r=e;return r.data=t,r};return r.useWorker?o.parseFeatureQuery(e.data,r).then(function(e){return t(e)}):t(u.parsePBFFeatureQuery(e.data,r))})},t.executeQueryForIds=function(e,t,r){return p(e,t,"json",r,{returnIdsOnly:!0})},t.executeQueryForCount=function(e,t,r){return p(e,t,"json",r,{returnIdsOnly:!0,returnCountOnly:!0})},t.executeQueryForExtent=function(e,t,r){return p(e,t,"json",r,{returnExtentOnly:!0,returnCountOnly:!0}).then(function(e){var t=e.data;if(t.hasOwnProperty("extent"))return e;if(t.features)throw new Error(f);if(t.hasOwnProperty("count"))throw new Error(f);return e})}}.apply(null,i))||(e.exports=o)},2282:function(e,t,r){var i,o;i=[r.dj.c(e.i),t,r(29),r(28),r(35),r(31),r(32),r(261),r(36),r(49),r(37),r(219),r(34),r(56),r(205),r(30),r(54),r(46),r(157),r(171),r(98),r(624),r(2283),r(2284),r(2285),r(367),r(2287),r(343)],void 0===(o=function(e,t,r,i,o,n,s,a,u,l,c,d,p,h,f,y,g,v,m,_,b,S,x,w,T,I,F,j){Object.defineProperty(t,"__esModule",{value:!0});var C=c.getLogger("esri.views.2d.layers.features.controllers.OnDemandController"),O=l("esri-featurelayer-webgl"),R=l("esri-mobile"),M={maxDrillLevel:O&&"object"==typeof O&&null!=O.maxDrillLevel?O.maxDrillLevel:R?1:4,maxRecordCountFactor:O&&"object"==typeof O&&null!=O.maxRecordCountFactor?O.maxRecordCountFactor:R?1:3,enablePBFQuery:!O||"object"!=typeof O||null==O.enablePBFQuery||O.enablePBFQuery},E=new Set,P=[],N=function(){function e(e,t){this.objectIdField=t,this.client=f.openWithPorts(e)}return e.prototype.destroy=function(){this.client.close(),this.client=null},e.prototype.executeQuery=function(e,t){return s(this,void 0,void 0,function(){var r;return n(this,function(i){switch(i.label){case 0:return[4,this.client.invoke("queryFeatures",e.toJSON(),t)];case 1:return r=i.sent(),[2,m.convertFromFeatureSet(r,this.objectIdField)]}})})},e}(),G=function(){function e(e){this.source=e}return e.prototype.destroy=function(){},e.prototype.executeQuery=function(e,t){return s(this,void 0,void 0,function(){return n(this,function(r){switch(r.label){case 0:return[4,_.executeQueryPBF(this.source,e,{type:"optimized"},t)];case 1:return[2,r.sent().data]}})})},e}(),Q=function(){function e(e,t){this.source=e,this.objectIdField=t}return e.prototype.destroy=function(){},e.prototype.executeQuery=function(e,t){return s(this,void 0,void 0,function(){var r;return n(this,function(i){switch(i.label){case 0:return[4,_.executeQuery(this.source,e,t)];case 1:return r=i.sent().data,[2,m.convertFromFeatureSet(r,this.objectIdField)]}})})},e}(),q=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.type="on-demand",t._queryInfoHash=null,t._dataTileIndex=new T.default,t._editsQueue=new x.EditsQueue({processEdits:t._processEdits.bind(t)}),t._featuresInFlight=new Map,t}return r(t,e),t.prototype.initialize=function(){var e=this,t=this._createFeatureStore();t.onFeatureAdd=this.onFeatureAdd.bind(this),t.onFeatureRemove=this.onFeatureRemove.bind(this),this._set("featureStore",t),this._dataTileIndex.featureStore=this.featureStore,this._dataTileIndex.forEach(function(e){return e.done=!1}),this._fetchQueue=new j({concurrency:10,strategy:"center-first",tileInfoView:this.tileStore.tileScheme,process:function(t,r){return e._fetchTile(t,e.queryInfo,r)}}),this._patchQueue=new j({concurrency:10,strategy:"center-first",tileInfoView:this.tileStore.tileScheme,process:function(t,r){return e._fetchTile(t.dataTile,t.queryInfo,r)}}),this._updateQueue=new F.default({tileInfoView:this.tileStore.tileScheme,process:function(t,r,i){return e._updateTile(t,r,i)}});var r=this.service,i=r.capabilities,o=r.source,n=r.objectIdField;Array.isArray(o)?this.sourceAdapter=new N(o,n):M.enablePBFQuery&&i.query.supportsFormatPBF?this.sourceAdapter=new G(o):this.sourceAdapter=new Q(o,n),this.handles.add([this.watch("updating",function(t){return!t&&e.onIdle()})]),this.featureStore.events.on("valueRangesChanged",function(t){e.remoteClient.invoke("emitEvent",{name:"valueRangesChanged",event:{valueRanges:t.valueRanges}})})},t.prototype.destroy=function(){this._fetchQueue.clear(),this._patchQueue.clear(),this._updateQueue.clear(),this._editsQueue.destroy(),this.queryEngine.destroy(),this.sourceAdapter.destroy()},Object.defineProperty(t.prototype,"queryEngine",{get:function(){return this._createQueryEngine(this.featureStore)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"updating",{get:function(){return!this.viewState||this._fetchQueue.updating||this._patchQueue.updating||this._updateQueue.updating||this._editsQueue.updating},enumerable:!0,configurable:!0}),t.prototype.update=function(e,t){return s(this,void 0,void 0,function(){var r,i,o,s,a,u,l=this;return n(this,function(n){switch(n.label){case 0:return this.validateConfig(e),r=JSON.stringify(this.config.filters),i=this.renderer.getAttributeHash(),o=e.availableFields.filter(function(e){return-1===l.availableFields.indexOf(e)}),s=this.config.definitionExpression,this._set("config",e),s!==this.config.definitionExpression&&this._set("queryEngine",this._createQueryEngine(this.featureStore)),[4,this.updatePixelBuffer()];case 1:return n.sent(),a=r!==JSON.stringify(e.filters),u=i!==this.renderer.getAttributeHash(),t?u?[4,this.attributeStore.setAttributeBindings(this.renderer,this.arcadeInfo)]:[3,3]:[3,6];case 2:n.sent(),n.label=3;case 3:return[4,this.attributeStore.updateFilters(this)];case 4:return n.sent(),[4,this.featureStore.update(a,e)];case 5:return n.sent(),this.refresh(),[2];case 6:return o.length?[4,this._handleAttributeChange(o)]:[3,8];case 7:n.sent(),n.label=8;case 8:return"heatmap"===this.renderer.type?[2]:u?[4,this.attributeStore.setAttributeBindings(this.renderer,this.arcadeInfo)]:[3,10];case 9:n.sent(),this.featureStore.forEach(function(e){return l.attributeStore.setAttributeData(e.localId,e,l.geometryInfo,l.viewParams)}),n.label=10;case 10:return[4,this.attributeStore.updateFilters(this)];case 11:return n.sent(),[4,this.featureStore.update(a,e)];case 12:return n.sent(),[4,this.attributeStore.sendUpdates()];case 13:return n.sent(),[2]}})})},t.prototype.invalidate=function(){return s(this,void 0,void 0,function(){var e,t,r;return n(this,function(i){for(e=0,t=this.tileStore.tiles;e<t.length;e++)r=t[e],this._updateQueue.push(r.id,Date.now());return[2]})})},t.prototype.onIdle=function(){this.featureStore.sweepClusters()},t.prototype.onEdits=function(e){var t=this;return this._fetchQueue.pause(),this._fetchQueue.reset(),this._editsQueue.push(e).then(function(){t._editsQueue.updating||t._fetchQueue.resume()})},t.prototype.queryFeatures=function(e){return this.queryEngine.executeQuery(e)},t.prototype.queryFeatureCount=function(e){return this.queryEngine.executeQueryForCount(e)},t.prototype.queryObjectIds=function(e){return this.queryEngine.executeQueryForIds(e)},t.prototype.queryExtent=function(e){return this.queryEngine.executeQueryForExtent(e)},t.prototype.queryStatistics=function(e){return s(this,void 0,void 0,function(){var e,t,r,i=this;return n(this,function(a){switch(a.label){case 0:return e=0,t=0,r=0,[4,p.all(this.tileStore.tiles.map(function(o){return s(i,void 0,void 0,function(){var i,s,a,u,l,c,p,h,f,y,g;return n(this,function(n){switch(n.label){case 0:return i=this.queryInfo,s=i.returnCentroid,a=i.returnGeometry,u=this._pixelBuffer,l={pixelBuffer:u,returnGeometry:a,returnCentroid:s,returnOutline:this.returnOutline},c=d(),[4,this.featureStore.executeTileQuery(o,this.spatialReference,l)];case 1:for(p=n.sent().features,h=d(),r+=h-c,e+=p.length,f=0,y=p;f<y.length;f++)(g=y[f]).geometry&&(v.isPolygon(g.geometry)?t+=g.geometry.rings.reduce(function(e,t){return e+t.length},0):v.isPolyline(g.geometry)&&(t+=g.geometry.paths.reduce(function(e,t){return e+t.length},0)));return[2]}})})}))];case 1:return a.sent(),[2,o({},this.featureStore.storeStatistics,{displayedFeatureCount:e,displayedVertexCount:t,displayPreProcessTime:r})]}})})},t.prototype.refresh=function(){return s(this,void 0,void 0,function(){var e=this;return n(this,function(t){switch(t.label){case 0:return this._queryInfoHash=Math.random().toString(),this._dataTileIndex.clear(),this._fetchQueue.pause(),this._updateQueue.pause(),this._editsQueue.clear(),this._fetchQueue.clear(),this._updateQueue.clear(),this.featureStore.startMarkingUsedFeatures(),this._manageTiles(this.tileStore.tiles),this._fetchQueue.resume(),[4,h.whenFalseOnce(this._fetchQueue,"updating")];case 1:return t.sent(),this.featureStore.sweep(),this.featureStore.forEach(function(t){return e.attributeStore.setAttributeData(t.localId,t,e.geometryInfo,e.viewParams)}),this.attributeStore.sendUpdates(),this._updateQueue.resume(),[2]}})})},t.prototype.setViewState=function(e){var t=this,r=this.viewState&&this.viewState.scale;this.inherited(arguments),this._fetchQueue.state=e,this._updateQueue.state=e,r!==this.viewState.scale&&this.attributeStore.hasScaleExpr&&(this.featureStore.forEach(function(e){return t.attributeStore.setAttributeData(e.localId,e,t.geometryInfo,t.viewParams)}),this.attributeStore.sendUpdates())},t.prototype.getAggregate=function(e){return this.featureStore.getAggregate(e)},t.prototype.getAggregateValueRanges=function(){return this.featureStore.getAggregateValueRanges()},t.prototype.onTileUpdate=function(e){this._manageTiles(e.added,e.removed),this.featureStore.onTileUpdate(e)},t.prototype.onFeatureAdd=function(e){if(this._featuresInFlight.has(e.objectId)){var t=this._featuresInFlight.get(e.objectId).attributes;e.attributes=o({},t,e.attributes),this._featuresInFlight.delete(e.objectId)}e.localId=this.attributeStore.createLocalId(e.objectId),this.attributeStore.setAttributeData(e.localId,e,this.geometryInfo,this.viewParams)},t.prototype._handleAttributeChange=function(e){return s(this,void 0,void 0,function(){return n(this,function(t){switch(t.label){case 0:return[4,this._fetchChangedFields(e)];case 1:return t.sent(),[2]}})})},t.prototype._fetchChangedTileFields=function(e,t){return s(this,void 0,void 0,function(){var r;return n(this,function(i){return(r=this._dataTileIndex.get(e.id))?(!1,[2,this._fetchChangedTileFieldsDrill(r,t)]):[2]})})},t.prototype._fetchChangedTileFieldsDrill=function(e,t,r){return void 0===r&&(r=0),s(this,void 0,void 0,function(){var i,s,a,u,l,c,d,h,f,y,g=this;return n(this,function(n){switch(n.label){case 0:return i=o({},this.queryInfo,{returnGeometry:!1,returnCentroid:!1,outFields:t.concat([this.service.objectIdField])}),e.returnExceeded=e.returnExceeded||r>=M.maxDrillLevel,s=e.key,a={key:s,dataTile:e,queryInfo:i},[4,this._patchQueue.push(a)];case 1:return(u=n.sent()).exceededTransferLimit&&r<M.maxDrillLevel?(l=e.tile.createChildTiles(),c=l.map(function(t){var r=new w.default;return r.tile=t,r.displayTile=e.displayTile,r}),[4,p.all(c.map(function(e){return g._fetchChangedTileFieldsDrill(e,t,r+1)}))]):[3,3];case 2:return n.sent(),[2];case 3:for(d=0,h=u.features;d<h.length;d++)f=h[d],this.featureStore.has(f.objectId)?(y=this.featureStore.getFeature(f.objectId)).attributes=o({},y.attributes,f.attributes):this._featuresInFlight.set(f.objectId,f);return[2]}})})},t.prototype._fetchChangedTileFieldsPaged=function(e,t,r){return void 0===r&&(r=0),s(this,void 0,void 0,function(){var i,s,a,u,l,c,d,p,h,f,y;return n(this,function(n){switch(n.label){case 0:return i=this.service.capabilities.query.supportsMaxRecordCountFactor,s=this.service.tileMaxRecordCount,a=s*(i?1:M.maxRecordCountFactor),u=o({},this.queryInfo,{returnGeometry:!1,returnCentroid:!1,outFields:t.concat([this.service.objectIdField]),resultOffset:r*a,num:a}),e.returnExceeded=!0,l=e.key,c={key:l,dataTile:e,queryInfo:u},[4,this._patchQueue.push(c)];case 1:for(d=n.sent(),p=0,h=d.features;p<h.length;p++)f=h[p],this.featureStore.has(f.objectId)?(y=this.featureStore.getFeature(f.objectId)).attributes=o({},y.attributes,f.attributes):this._featuresInFlight.set(f.objectId,f);return d.exceededTransferLimit?[2,this._fetchChangedTileFieldsPaged(e,t,r+1)]:[2]}})})},t.prototype._fetchChangedFields=function(e){return s(this,void 0,void 0,function(){var t,r,i=this;return n(this,function(o){switch(o.label){case 0:return t=this.tileStore.tiles,r=t.map(function(t){return i._fetchChangedTileFields(t,e)}),[4,p.all(r)];case 1:return o.sent(),[2]}})})},t.prototype._manageTiles=function(e,t){void 0===t&&(t=null);for(var r=this._dataTileIndex,i=this._fetchQueue,o=this._updateQueue,n="esriGeometryPoint"===this.service.geometryType,s=this,a=0,u=e;a<u.length;a++){!function(e){var t=r.get(e.id);t?(t.displayTile=e,n?r.forEach(function(r){I.isChildOf(r,t)&&(r.displayTile=e)}):t.done=!1):((t=new w.default).tile=e.clone(),t.displayTile=e,r.add(t)),s._processDataTile(t)}(d=u[a])}if(t)for(var l=0,c=t;l<c.length;l++){var d=c[l];E.add(d),o.abort(d.id)}r.forEach(function(e){E.has(e.displayTile)&&P.push(e)});for(var p=0,h=P;p<h.length;p++){var f=h[p];i.abort(f.id),r.delete(f)}P.length=0,E.clear()},t.prototype._processDataTile=function(e){var t=this,r=e.displayTile,i=e.key,o=this._dataTileIndex,n=this._fetchQueue,s=i.id,a=this._queryInfoHash,l=i.level-r.key.level>=M.maxDrillLevel;if(o.add(e),e.done||n.has(s)){if(e.queryInfoHash!==a||e.returnExceeded!==l)if(e.done)e.done=!1;else{if(!n.isOngoing(s))return e.queryInfoHash=a,void(e.returnExceeded=l);n.abort(s)}}else e.queryInfoHash=a,e.returnExceeded=l;e.done?this._invalidateTile(e.displayTile):n.has(s)||n.push(e).then(function(r){return t._handleResponse(e,r)}).catch(function(r){p.isAbortError(r)||C.error(new u("featurelayer-controller:tile-error","Encountered an error when handling tile response",r)),e.done=!0,t._invalidateTile(e.displayTile)})},t.prototype._handleResponse=function(e,t){if(e.done=!0,m.hydrateOptimizedFeatureSet(t),t.exceededTransferLimit)if(e.returnExceeded)this._dataTileIndex.setTileFeatures(e,t.features),this._deleteChildrenDataTiles(e);else{for(var r=e.tile.createChildTiles(),i=0,o=r;i<o.length;i++){var n=o[i],s=new w.default;s.tile=n,s.displayTile=e.displayTile,this._processDataTile(s)}a.release(r)}else this._dataTileIndex.setTileFeatures(e,t.features),this._deleteChildrenDataTiles(e);this._invalidateTile(e.tile)},t.prototype._deleteChildrenDataTiles=function(e){this._dataTileIndex.forEach(function(t){I.isChildOf(t,e)&&P.push(t)});for(var t=0,r=P;t<r.length;t++){var i=r[t];this._fetchQueue.abort(i.id),this._dataTileIndex.delete(i)}P.length=0},t.prototype._fetchTile=function(e,t,r){return s(this,void 0,void 0,function(){var i,o,s,a,u,l,c,d,p,h,f;return n(this,function(n){switch(n.label){case 0:return i=new g({xmin:e.bounds[0],ymin:e.bounds[1],xmax:e.bounds[2],ymax:e.bounds[3],spatialReference:this.spatialReference}),o=this.service.geometryType,s="esriGeometryPoint"===o?e.tile:e.displayTile,a=s.extent,u=s.resolution,l=e.returnExceeded,c=this._createQuery(i,a,u,t,M.maxRecordCountFactor,l),[4,this.sourceAdapter.executeQuery(c,r)];case 1:if(d=n.sent(),"esriGeometryPolygon"===o)for(p=0,h=d.features;p<h.length;p++)(f=h[p]).geometry=m.removeCollinearVectices(f.geometry,f.geometry,o,!1,!1);return[2,d]}})})},t.prototype._invalidateTile=function(e){for(var t=this._pixelBuffer,r=this._updateQueue,i=0,o=this.tileStore.intersections(e,t);i<o.length;i++){var n=o[i].tile;r.push(n.id,n.updateTimestamp)}},t.prototype._updateTile=function(e,t,r){return s(this,void 0,void 0,function(){var i,o,s,a,u,l,c,d,h,f,y,g,v=this;return n(this,function(n){switch(n.label){case 0:return i=this.tileStore.get(e),o=this.queryInfo,s=o.returnCentroid,a=o.returnGeometry,u=this._pixelBuffer,l={pixelBuffer:u,returnGeometry:a,returnCentroid:s,returnOutline:this.returnOutline},[4,this.featureStore.executeTileQuery(i,this.spatialReference,l)];case 1:return c=n.sent(),d=c.features,h=c.objectIds,[4,this.attributeStore.sendUpdates()];case 2:return n.sent(),f={geometryType:this.service.geometryType,features:d,fields:this.service.fields,objectIdFieldName:this.service.objectIdField,transform:i.transform},y=[],g=!0,this._dataTileIndex.forEach(function(e){i.id!==e.id&&I.isChildOf(e,i)&&g&&!e.done&&(g=!1)}),g&&i&&i.objectIds.forEach(function(e){if(!h.has(e)){var t=v.attributeStore.getLocalId(e);y.push(t)}}),h.forEach(function(e){i.objectIds.add(e)}),i.updateTimestamp=t,[2,this.processor.onTileData(i,{clear:!0,addOrUpdate:f.features,remove:y,transformParams:b.Utils.getTransformParams(f)},r).catch(function(e){p.isAbortError(e)||C.error("update-tile",e)})]}})})},t.prototype._processEdits=function(e,t,r){return s(this,void 0,void 0,function(){var i,a,u,l,c,d=this;return n(this,function(h){switch(h.label){case 0:return i=this._createTempQueryEngine(),a=this._createObjectIdsQuery(e),e.length?[4,this.sourceAdapter.executeQuery(a)]:[3,2];case 1:u=h.sent(),m.hydrateOptimizedFeatureSet(u),this._dataTileIndex.addOrUpdateFeatures(u.features),i.featureStore.addMany(u.features),h.label=2;case 2:return l=t.concat(e).map(function(e){return d.attributeStore.getLocalId(e)}),this._dataTileIndex.deleteFeaturesById(t),this.attributeStore.sendUpdates(),c=o({},this.queryInfo,{pixelBuffer:this._pixelBuffer,returnOutline:this.returnOutline}),this.tileStore.tiles.map(function(e){return s(d,void 0,void 0,function(){var t,o;return n(this,function(n){switch(n.label){case 0:return[4,i.featureStore.executeTileQuery(e,this.spatialReference,c)];case 1:return t=n.sent().features,o={transform:e.transform,hasZ:!1,hasM:!1},[2,this.processor.onTileData(e,{addOrUpdate:t,remove:l,transformParams:o},r).catch(function(e){p.isAbortError(e)||C.error("update-tile",e)})]}})})}),i.destroy(),[2]}})})},t.prototype._createObjectIdsQuery=function(e){var t=this._createDefaultQuery(this.queryInfo);return t.objectIds=e,t},i([y.property()],t.prototype,"_fetchQueue",void 0),i([y.property()],t.prototype,"_patchQueue",void 0),i([y.property()],t.prototype,"_updateQueue",void 0),i([y.property()],t.prototype,"_editsQueue",void 0),i([y.property({readOnly:!0})],t.prototype,"featureStore",void 0),i([y.property()],t.prototype,"sourceAdapter",void 0),i([y.property({readOnly:!0,dependsOn:["featureStore","service"]})],t.prototype,"queryEngine",null),i([y.property({dependsOn:["viewState","_fetchQueue.updating","_updateQueue.updating","_patchQueue.updating","_editsQueue.updating"]})],t.prototype,"updating",null),i([y.subclass("esri.views.2d.layers.features.controllers.OnDemandController")],t)}(y.declared(S.default));t.default=q}.apply(null,i))||(e.exports=o)},2283:function(e,t,r){var i,o;i=[r.dj.c(e.i),t,r(28),r(31),r(32),r(29),r(47),r(34),r(30),r(6)],void 0===(o=function(e,t,r,i,o,n,s,a,u){Object.defineProperty(t,"__esModule",{value:!0});var l=function(e){function t(t){var r=e.call(this,t)||this;return r._queue=[],r._onGoingRequest=null,r._abortController=a.createAbortController(),r}return n(t,e),t.prototype.destroy=function(){this.clear()},Object.defineProperty(t.prototype,"updating",{get:function(){return!this.destroyed&&(this._queue.length>0||null!=this._onGoingRequest)},enumerable:!0,configurable:!0}),t.prototype.clear=function(){if(this.destroyed)throw new Error("instance is already destroyed");for(var e=this._queue.pop();e;)e.resolver.reject(a.createAbortError()),e=this._queue.pop();this._queue.length=0,this._abortController.abort(),this._abortController=a.createAbortController()},t.prototype.push=function(e){return o(this,void 0,void 0,function(){var t,r=this;return i(this,function(i){if(this.destroyed)throw new Error("instance is already destroyed");return t=a.createResolver(),this._queue.push({event:e,resolver:t}),this.notifyChange("updating"),Promise.resolve().then(function(){r._processNext()}),[2,t.promise]})})},t.prototype._processNext=function(){return o(this,void 0,void 0,function(){var e,t,r,o,n,s,a,u,l,c,d,p,h,f,y,g,v,m,_,b,S,x,w=this;return i(this,function(i){switch(i.label){case 0:if(this._onGoingRequest)return[2];for(e=[],t=new Set,r=new Set,o=new Set,n=this._queue.shift();n;){for(s=n.event,a=s.addedFeatures,u=s.deletedFeatures,l=s.updatedFeatures,c=n.resolver,e.push(c),d=0,p=a;d<p.length;d++)h=p[d],b=h.objectId,h.error||(t.add(b),r.add(b),o.delete(b));for(f=0,y=l;f<y.length;f++)g=y[f],b=g.objectId,g.error||(r.add(b),o.delete(b));for(v=0,m=u;v<m.length;v++)_=m[v],b=_.objectId,_.error||(t.has(b)?t.delete(b):o.add(b),r.delete(b));n=this._queue.shift()}return r.size||o.size?(S=[],x=[],r.size&&r.forEach(function(e){S.push(e)}),o.size&&o.forEach(function(e){x.push(e)}),this._onGoingRequest=Promise.resolve().then(function(){return w.processEdits(S,x,{signal:w._abortController.signal})}).catch(function(){}),this.notifyChange("updating"),[4,this._onGoingRequest]):(this.notifyChange("updating"),e.forEach(function(e){return e()}),[2]);case 1:return i.sent(),this._onGoingRequest=null,this.notifyChange("updating"),e.forEach(function(e){return e()}),this._queue.length>0&&this._processNext(),[2]}})})},r([u.property({constructOnly:!0})],t.prototype,"processEdits",void 0),r([u.property({readOnly:!0})],t.prototype,"updating",null),r([u.subclass("esri.views.2d.layers.features.controllers.EditsQueue")],t)}(u.declared(s));t.EditsQueue=l}.apply(null,i))||(e.exports=o)},2284:function(e,t,r){var i,o;i=[r.dj.c(e.i),t],void 0===(o=function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){this.displayTile=null,this.tile=null,this.done=!1,this.queryInfoHash=null,this.returnExceeded=!1}return Object.defineProperty(e.prototype,"key",{get:function(){return this.tile.key},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"id",{get:function(){return this.tile.id},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bounds",{get:function(){return this.tile.bounds},enumerable:!0,configurable:!0}),e}();t.default=r}.apply(null,i))||(e.exports=o)},2285:function(e,t,r){var i,o;i=[r.dj.c(e.i),t,r(2286),r(267),r(367)],void 0===(o=function(e,t,r,i,o){Object.defineProperty(t,"__esModule",{value:!0});var n=[],s=new Set,a=function(){function e(){this._tileById=new Map,this._tilesToFeatures=new Map,this._featureToTiles=new Map}return e.prototype.destroy=function(){this.clear()},e.prototype.add=function(e){var t=this;if(!this.has(e.id)){var i=e;this._tileById.set(i.id,i),this._tilesToFeatures.set(i,r.default.acquire()),this._tilesToFeatures.forEach(function(e,r){i!==r&&(o.isParentOf(i,r)?e.forEach(function(e){t._link(i,e)}):o.isChildOf(i,r)&&t.featureStore.forEachInBounds(i.bounds,function(r){e.has(r.objectId)&&t._link(i,r.objectId)}))})}},e.prototype.clear=function(){this._tilesToFeatures.forEach(function(e){return r.default.release(e)}),this._tilesToFeatures.clear(),this._featureToTiles.forEach(function(e){return r.default.release(e)}),this._featureToTiles.clear(),this._tileById.clear()},e.prototype.delete=function(e){var t=this,r=this.get(e.id);n.length=0,this._tilesToFeatures.get(r).forEach(function(e){var i=t._featureToTiles.get(e);i.has(r)&&1===i.size?n.push(e):t._unlink(r,e)});for(var i=0,o=n;i<o.length;i++){var s=o[i];this._unlink(r,s)}this.featureStore.removeManyById(n),this._tilesToFeatures.delete(r),this._tileById.delete(r.id),n.length=0},e.prototype.forEach=function(e,t){return this._tileById.forEach(e,t)},e.prototype.get=function(e){return this._tileById.get(e)},e.prototype.has=function(e){return this._tileById.has(e)},e.prototype.setTileFeatures=function(e,t){var i=this,o=this.get(e.id);this._tilesToFeatures.has(o)||(this._tileById.set(o.id,o),this._tilesToFeatures.set(o,r.default.acquire()));for(var a=0,u=t;a<u.length;a++){var l=u[a];s.add(l.objectId)}n.length=0,this._tilesToFeatures.get(o).forEach(function(e){if(!s.has(e)){var t=i._featureToTiles.get(e);t.has(o)&&1===t.size?n.push(e):i._unlink(o,e)}});for(var c=0,d=n;c<d.length;c++){var p=d[c];this._unlink(o,p)}this.featureStore.removeManyById(n),this.featureStore.addMany(t),s.forEach(function(e){i._link(o,e)}),s.clear(),n.length=0},e.prototype.addOrUpdateFeatures=function(e){for(var t=this,r=new Set,o=new i.default({geometryType:this.featureStore.geometryType,hasM:this.featureStore.hasM,hasZ:this.featureStore.hasZ}),n=0,s=this.deleteFeaturesById(e.map(function(e){return e.objectId}));n<s.length;n++){var a=s[n];r.add(a)}o.addMany(e),this._tileById.forEach(function(e){o.forEachInBounds(e.bounds,function(i){t._link(e,i.objectId),r.add(e)})}),this.featureStore.addMany(e);var u=[];return r.forEach(function(e){return u.push(e)}),u},e.prototype.deleteFeaturesById=function(e){for(var t=this,i=new Set,o=this,n=0,s=e;n<s.length;n++){!function(e){var n=o._featureToTiles.get(e);n&&(n.forEach(function(r){i.add(r),t._tilesToFeatures.get(r).delete(e)}),r.default.release(n),o._featureToTiles.delete(e))}(s[n])}this.featureStore.removeManyById(e);var a=[];return i.forEach(function(e){return a.push(e)}),a},e.prototype._link=function(e,t){this._featureToTiles.get(t)||this._featureToTiles.set(t,r.default.acquire()),this._featureToTiles.get(t).add(e),this._tilesToFeatures.get(e).add(t)},e.prototype._unlink=function(e,t){this._featureToTiles.get(t).delete(e),this._tilesToFeatures.get(e).delete(t),0===this._featureToTiles.get(t).size&&(r.default.release(this._featureToTiles.get(t)),this._featureToTiles.delete(t))},e}();t.default=a}.apply(null,i))||(e.exports=o)},2286:function(e,t,r){var i,o;i=[r.dj.c(e.i),t],void 0===(o=function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){this._pool=[],this._set=new Set}return e.prototype.acquire=function(){if(0===this._pool.length)return new Set;var e=this._pool.pop();return this._set.delete(e),e},e.prototype.release=function(e){e&&!this._set.has(e)&&(e.clear(),this._pool.length<5e4&&(this._pool.push(e),this._set.add(e)))},e.acquire=function(){return i.acquire()},e.release=function(e){return i.release(e)},e}();t.default=r;var i=new r}.apply(null,i))||(e.exports=o)},2287:function(e,t,r){var i,o;i=[r.dj.c(e.i),t,r(29),r(28),r(31),r(32),r(47),r(34),r(146),r(30),r(147),r(516)],void 0===(o=function(e,t,r,i,o,n,s,a,u,l,c,d){Object.defineProperty(t,"__esModule",{value:!0});var p=[0,0],h=function(e){function t(t){var r=e.call(this,t)||this;return r._queue=new Map,r._isPaused=!1,r._scheduledNextHandle=null,r._timestamp=Date.now(),r.tileInfoView=null,r._next=r._next.bind(r),r._finalize=r._finalize.bind(r),r}return r(t,e),Object.defineProperty(t.prototype,"length",{get:function(){return this._queue.size},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"updating",{get:function(){return this._queue.size>0||null!=this._onGoingTile},enumerable:!0,configurable:!0}),t.prototype.abort=function(e){this._onGoingTile&&this._onGoingTile.tileId===e&&(this._onGoingTile.abortController.abort(),this._onGoingTile=null),this._queue.delete(e),this._scheduleNext(),this.notifyChange("updating")},t.prototype.clear=function(){this._queue.clear(),this._onGoingTile&&(this._onGoingTile.abortController.abort(),this._onGoingTile=null),this._cancelNext(),this.notifyChange("updating")},t.prototype.has=function(e){return this._queue.has(e)},t.prototype.isOngoing=function(e){return this._onGoingTile&&this._onGoingTile.tileId===e},t.prototype.pause=function(){this._isPaused||(this._isPaused=!0,this._cancelNext())},t.prototype.push=function(e,t){if(!this._queue.has(e)){var r=a.createAbortController();this._queue.set(e,{tileId:e,key:d.TileKey.pool.acquire(e),timestamp:t||this._timestamp,abortController:r}),this._scheduleNext(),this.notifyChange("updating")}},t.prototype.refresh=function(){this._timestamp=Date.now(),this.reset()},t.prototype.reset=function(){var e=this._onGoingTile;if(e){var t=e.tileId;this.push(t,this._timestamp)}this.notifyChange("updating")},t.prototype.resume=function(){this._isPaused&&(this._isPaused=!1,this._scheduleNext()),this.notifyChange("updating")},t.prototype._finalize=function(){this._onGoingTile=null,this.notifyChange("updating"),this._scheduleNext()},t.prototype._cancelNext=function(){this._scheduledNextHandle&&(this._scheduledNextHandle.remove(),this._scheduledNextHandle=null)},t.prototype._scheduleNext=function(){this._isPaused||this._scheduledNextHandle||0===this._queue.size||null!=this._onGoingTile||(this._scheduledNextHandle=u.schedule(this._next))},t.prototype._next=function(){return n(this,void 0,void 0,function(){var e,t,r,i,n;return o(this,function(o){switch(o.label){case 0:if(null==this._scheduledNextHandle||0===this._queue.size||this._onGoingTile)return this._scheduledNextHandle=null,[2];if(this._scheduledNextHandle=null,e=this._peek(),t=e.abortController.signal,r=e.tileId,i=e.key,d.TileKey.pool.release(i),this._queue.delete(r),this._onGoingTile=e,n=this.process(r,this._timestamp,{signal:t}),this.notifyChange("updating"),!function(e){return e&&"function"==typeof e.then}(n))return[3,4];o.label=1;case 1:return o.trys.push([1,3,,4]),[4,n];case 2:return o.sent(),[3,4];case 3:return o.sent(),[3,4];case 4:return this._finalize(),[2]}})})},t.prototype._peek=function(){var e=this;if(!this.state)throw new Error("state not set");var t=this.tileInfoView,r=this.state.center,i=Number.NEGATIVE_INFINITY,o=Number.POSITIVE_INFINITY,n=null;return this._queue.forEach(function(s){t.getTileCoords(p,s.key);var a=e._timestamp-s.timestamp;if(isNaN(a))(u=c.vec2.distance(p,r))<o&&(o=u,n=s);else if(a===i){var u;(u=c.vec2.distance(p,r))<o&&(o=u,n=s)}else a>i&&(i=a,o=Number.POSITIVE_INFINITY,n=s)}),n},i([l.property({readOnly:!0})],t.prototype,"length",null),i([l.property({constructOnly:!0})],t.prototype,"process",void 0),i([l.property()],t.prototype,"state",void 0),i([l.property({constructOnly:!0})],t.prototype,"tileInfoView",void 0),i([l.property({readOnly:!0})],t.prototype,"updating",null),i([l.subclass("esri.views.2d.layers.features.support.TileUpdateQueue")],t)}(l.declared(s));t.default=h}.apply(null,i))||(e.exports=o)},294:function(e,t,r){var i,o;i=[r.dj.c(e.i),t],void 0===(o=function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.queryCapabilities={supportsStatistics:!0,supportsCentroid:!0,supportsCacheHint:!1,supportsDistance:!0,supportsDistinct:!0,supportsExtent:!0,supportsGeometryProperties:!1,supportsHavingClause:!0,supportsOrderBy:!0,supportsPagination:!0,supportsQuantization:!0,supportsQuantizationEditMode:!1,supportsQueryGeometry:!0,supportsResultType:!1,supportsSqlExpression:!0,supportsMaxRecordCountFactor:!1,supportsStandardizedQueriesOnly:!0,supportsQueryByOthers:!0,supportsHistoricMoment:!1,supportsFormatPBF:!1,supportsDisjointSpatialRelationship:!0,maxRecordCountFactor:void 0,maxRecordCount:void 0,standardMaxRecordCount:void 0,tileMaxRecordCount:void 0}}.apply(null,i))||(e.exports=o)},394:function(e,t,r){var i,o;i=[r.dj.c(e.i),t],void 0===(o=function(e,t){function r(e){return e<=57?e-48:e<=104?e-88:e<=107?e-89:e<=110?e-90:e-91}function i(e){return F[e]}function o(e){return(e[0]+e[1])/2}function n(e,t,r){return e[0]=t,e[1]=r,e}function s(e,t){var r=o(e),i=t,n=!t;e[0]=n*e[0]+i*r,e[1]=n*r+i*e[1]}function a(e,t){var r=t>o(e);return s(e,r),r}function u(e,t){for(var i=n(b,x,w),a=n(S,T,I),u=0;u<t.length;u++){var l=r(t.charCodeAt(u));u%2==0?(s(a,!!(y&l)),s(a,!!(v&l)),s(a,!!(_&l)),s(i,!!(g&l)),s(i,!!(m&l))):(s(i,!!(y&l)),s(i,!!(v&l)),s(i,!!(_&l)),s(a,!!(g&l)),s(a,!!(m&l)))}return e[0]=o(i),e[1]=o(a),e}function l(e,t,r){for(var o="",s=n(b,-90,90),u=n(S,-180,180),l=0;l<r;l++){var c=0;l%2?(c|=a(s,e)<<4,c|=a(u,t)<<3,c|=a(s,e)<<2,c|=a(u,t)<<1,c|=a(s,e)<<0):(c|=a(u,t)<<4,c|=a(s,e)<<3,c|=a(u,t)<<2,c|=a(s,e)<<1,c|=a(u,t)<<0),o+=i(c)}return o}function c(e){var t=Math.floor(5*e/2);return(w-x)/Math.pow(2,t)}function d(e){var t=Math.ceil(5*e/2);return(I-T)/Math.pow(2,t)}function p(e,t){return t?_&e|(v&e)>>1|(y&e)>>2:(m&e)>>1|(g&e)>>2}function h(e,t){return t?(m&e)>>1|(g&e)>>2:_&e|(v&e)>>1|(y&e)>>2}function f(e,t,o){var n=!((e.length-1)%2),s=e.substring(0,e.length-1),a=r(e.charCodeAt(e.length-1)),u=0,l=0,c=0,d=0;n?(u=8,l=4,c=_&a|(v&a)>>1|(y&a)>>2,d=(m&a)>>1|(g&a)>>2):(u=4,l=8,d=_&a|(v&a)>>1|(y&a)>>2,c=(m&a)>>1|(g&a)>>2);var p=c+t,h=d+o,b=Math.floor(p/u),S=Math.floor(h/l),x=i(function(e,t,r){return r?e&_|(t&_)<<1|(e&m)<<1|(t&m)<<2|(e&v)<<2:t&_|(e&_)<<1|(t&m)<<1|(e&m)<<2|(t&v)<<2}(p-b*u,h-S*l,n));return e.length>1&&(b||S)?f(s,b,S)+x:s+x}Object.defineProperty(t,"__esModule",{value:!0});var y=16,g=8,v=4,m=2,_=1,b=new Float64Array(2),S=new Float64Array(2),x=-90,w=90,T=-180,I=180,F="0123456789bcdefghjkmnpqrstuvwxyz";t.decodeBase32Char=r,t.encodeBase32Char=i,t.decodeGeohash=u,t.convertGeohash32ToXY=function(e,t){for(var i=0,o=0,n=30,s=30,a=0;a<t.length;a++){var u=r(t.charCodeAt(a)),l=a%2==0;i|=p(u,l)<<(n-=l?3:2),o|=h(u,l)<<(s-=l?2:3)}return{geohashX:i,geohashY:o}},t.decodeGeohashXY=function(e,t){for(var r=-90,i=90,o=-180,n=180,s=0;s<t;s++){for(var a=Math.ceil((s+1)/2),u=Math.floor((s+1)/2),l=1-s%2,c=30-(3*a+2*u),d=30-(2*a+3*u),p=3*l+2*(1-l),h=2*l+3*(1-l),f=3*l+7*(1-l)<<d,y=(7*l+3*(1-l)<<c&e.geohashX)>>c,g=(f&e.geohashY)>>d,v=p-1;v>=0;v--){var m=(o+n)/2,_=y&1<<v?1:0;o=(1-_)*o+_*m,n=(1-_)*m+_*n}for(v=h-1;v>=0;v--){var b=(r+i)/2,S=g&1<<v?1:0;r=(1-S)*r+S*b,i=(1-S)*b+S*i}}return[o,r,n,i]},t.setGeohashXY=function(e,t,r,i){i%2&&(i+=1);for(var o=0,n=0,s=-90,a=90,u=-180,l=180,c=0;c<i/2;c++){for(var d=0;d<5;d++){var p=(u+l)/2,h=r>p?1:0;o|=h<<29-(d+5*c),u=(1-h)*u+h*p,l=(1-h)*p+h*l}for(d=0;d<5;d++){var f=(s+a)/2,y=t>f?1:0;n|=y<<29-(d+5*c),s=(1-y)*s+y*f,a=(1-y)*f+y*a}}e.geohashX=o,e.geohashY=n},t.encodeGeohash=l,t.latDistPerGeohash=c,t.lonDistPerGeohash=d,t.unpackXBits=p,t.unpackYBits=h,t.getRelativeGeohash=f,t.getIntersectingGeohashes=function(e,t,r,i,o){for(var n=Math.abs(r-e),s=Math.abs(i-t),a=c(o),u=d(o),p=Math.ceil(s/u),h=Math.ceil(n/a),y=l(e,t,o),g=new Array,v=0;v<p;v++)for(var m=0;m<h;m++)g.push(f(y,v,m));return g},t.forEachIntersectingGeohash=function(e,t,r,i,o,n){for(var s=Math.abs(r-e),a=Math.abs(i-t),p=c(o),h=d(o),y=Math.ceil(a/h),g=Math.ceil(s/p),v=l(e,t,o),m=0;m<y;m++)for(var _=0;_<g;_++){var b=f(v,m,_),S=u([0,0],b),x=S[0],w=S[1],T=x-p/2,I=w-h/2,F=x+p/2,j=w+h/2,C=p*h,O=Math.max(e,T),R=Math.max(t,I),M=Math.min(r,F)-O,E=Math.min(i,j)-R;n(b,Math.abs(M*E)/C)}}}.apply(null,i))||(e.exports=o)},624:function(e,t,r){var i,o;i=[r.dj.c(e.i),t,r(28),r(31),r(32),r(29),r(35),r(36),r(141),r(49),r(37),r(40),r(34),r(30),r(215),r(229),r(148),r(195),r(85),r(74),r(98),r(549),r(625),r(627)],void 0===(o=function(e,t,r,i,o,n,s,a,u,l,c,d,p,h,f,y,g,v,m,_,b,S,x,w){Object.defineProperty(t,"__esModule",{value:!0});var T=c.getLogger("esri.views.2d.layers.features.controllers.BaseController"),I=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._availableFields=[],t._pixelBuffer=0,t.config=null,t.filters=new Array(b.definitions.MAX_FILTERS),t.processor=null,t.remoteClient=null,t.service=null,t.tileStore=null,t}return n(t,e),t.prototype.initialize=function(){this.handles.add([this.tileStore.on("update",this.onTileUpdate.bind(this))]),this._initAttributeStore()},t.prototype.startup=function(){return o(this,void 0,void 0,function(){return i(this,function(e){switch(e.label){case 0:return this._initAttributeStore(),[4,this.attributeStore.setAttributeBindings(this.renderer,this.arcadeInfo)];case 1:return e.sent(),[4,p.all([this.attributeStore.updateFilters(this),this.updatePixelBuffer()])];case 2:return e.sent(),[2]}})})},t.prototype.destroy=function(){this.attributeStore&&this.attributeStore.destroy()},Object.defineProperty(t.prototype,"arcadeInfo",{get:function(){return{geometryType:this.service.geometryType,fields:this.service.fields,spatialReference:this.spatialReference}},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"featureReduction",{get:function(){return this.config.featureReduction},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"fieldsIndex",{get:function(){return new g(this.service.fields)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"geometryInfo",{get:function(){return{geometryType:this.service.geometryType,hasZ:!1,hasM:!1}},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"returnCentroid",{get:function(){return this._get("returnCentroid")||function(e,t,r){function i(e){if(!e)return!1;var t=e.type;return"simple-marker"===t||"picture-marker"===t||"text"===t||"web-style"===t||"cim"===t}if("esriGeometryPolygon"===t&&e.labelingInfo)return!0;if("esriGeometryPolygon"!==t)return!1;switch(r.type){case"simple":return i(r.symbol);case"unique-value":return i(r.defaultSymbol)||r.uniqueValueInfos.some(function(e){return i(e.symbol)});case"class-breaks":return i(r.defaultSymbol)||r.classBreakInfos.some(function(e){return i(e.symbol)});case"dot-density":return!1;default:return!0}}(this.config,this.service.geometryType,this.renderer)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"returnOutline",{get:function(){return function(e,t){switch(e){case"esriGeometryPoint":case"esriGeometryPolyline":case"esriGeometryMultipoint":return!0;case"esriGeometryPolygon":return function(e){var t=e&&e.getSymbols();return"backgroundFillSymbol"in e&&null!=e.backgroundFillSymbol&&"outline"in e.backgroundFillSymbol&&null!=e.backgroundFillSymbol.outline||t.some(function(e){return"outline"in e&&null!=e.outline})}(t)}}(this.service.geometryType,this.renderer)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"queryInfo",{get:function(){return{returnCentroid:this.returnCentroid,returnGeometry:!0,outFields:this.availableFields,definitionExpression:this.config.definitionExpression,gdbVersion:this.config.gdbVersion,historicMoment:this.config.historicMoment}},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"renderer",{get:function(){return this.config?v.fromJSON(this.config.renderer):(T.error("mapview-controller","Unable to create renderer for undefined configuration"),null)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"availableFields",{get:function(){var e=this,t=this.config.availableFields.filter(function(t){return-1===e._availableFields.indexOf(t)});return this._availableFields=this._availableFields.concat(t),this._availableFields},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"spatialReference",{get:function(){return this.tileStore.tileScheme.spatialReference},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"viewParams",{get:function(){return{viewingMode:"",scale:this.viewState&&this.viewState.scale||1}},enumerable:!0,configurable:!0}),t.prototype.getObjectId=function(e){return this.attributeStore.getFeatureId(e)},t.prototype.getAggregate=function(e){return null},t.prototype.getAggregateValueRanges=function(){return{}},t.prototype.getLocalId=function(e){return this.attributeStore.getLocalId(e)},t.prototype.mapValidLocalIds=function(e){var t=this;return e.map(function(e){return t.attributeStore.getLocalId(e)}).filter(function(e){return null!=e})},t.prototype.setViewState=function(e){this._set("viewState",e)},t.prototype.updatePixelBuffer=function(){return o(this,void 0,void 0,function(){var e;return i(this,function(t){switch(t.label){case 0:return[4,w.computePxBuffer(this.renderer,this.service.geometryType)];case 1:return e=t.sent(),this._pixelBuffer=Math.max(this._pixelBuffer,e),[2]}})})},t.prototype.setHighlight=function(e){return o(this,void 0,void 0,function(){return i(this,function(t){return[2,this.attributeStore.setHighlight(e)]})})},t.prototype.validateConfig=function(e){for(var t=0,r=e.filters;t<r.length;t++){var i=r[t];if(d.isSome(i)&&i.where)try{f.validateWhere(this.fieldsIndex,i.where)}catch(e){throw new a("mapview-bad-filter",e.message,{filter:i,missingFields:e.details})}}},t.prototype.onFeatureAdd=function(e){e.localId=this.attributeStore.createLocalId(e.objectId),this.attributeStore.setAttributeData(e.localId,e,this.geometryInfo,this.viewParams)},t.prototype.onFeatureRemove=function(e){!e.localId&&l("esri-2d-debug")&&console.debug("Feature must have localId"),this.attributeStore.freeLocalId(e.objectId)},t.prototype.enableEvent=function(e){},t.prototype._initAttributeStore=function(){var e=this;this.attributeStore?this.attributeStore.invalidateResources():this.attributeStore=new S.default({type:"remote",initialize:function(t,r){return e.remoteClient.invoke("tileRenderer.featuresView.attributeView.initialize",t,{signal:r})},update:function(t,r){return e.remoteClient.invoke("tileRenderer.featuresView.attributeView.requestUpdate",t,{signal:r})},render:function(){return e.remoteClient.invoke("tileRenderer.featuresView.requestRender")}})},t.prototype._createQueryEngine=function(e){return new y.default({definitionExpression:this.config.definitionExpression,fields:this.service.fields,geometryType:this.service.geometryType,objectIdField:this.service.objectIdField,hasM:!1,hasZ:!1,spatialReference:this.spatialReference.toJSON(),cacheSpatialQueries:!0,featureStore:e,timeInfo:this.service.timeInfo})},t.prototype._createTempQueryEngine=function(e){return void 0===e&&(e=this._createFeatureStore()),this._createQueryEngine(e)},t.prototype._createFeatureStore=function(){var e={geometryType:this.service.geometryType,hasM:!1,hasZ:!1};return new x.ClusterStore(e,this.spatialReference,this.attributeStore,this.featureReduction)},t.prototype._createDefaultQuery=function(e){var t=new _,r=e.outFields,i=this.config,o=i.gdbVersion,n=i.historicMoment,s=i.definitionExpression;return r=r.length/this.service.fields.length>=.75?["*"]:r,t.gdbVersion=o,t.historicMoment=null!=n?new Date(n):null,t.num=e.num,t.outFields=r,t.outSpatialReference=this.spatialReference,t.returnGeometry=e.returnGeometry,t.returnCentroid=e.returnCentroid,t.start=e.resultOffset,t.where=s||"1=1",t},t.prototype._createQuery=function(e,t,r,i,o,n){var s=this.service.geometryType,a=this._createDefaultQuery(i);return a.maxRecordCountFactor=o,a.returnExceededLimitFeatures=n,a.resultType="tile",a.geometry=e,this.service.capabilities.query.supportsQuantization?(a.quantizationParameters=new m.default({mode:"view",originPosition:"upper-left",tolerance:r,extent:t}),"esriGeometryPolyline"===s&&(a.maxAllowableOffset=r)):"esriGeometryPolyline"!==s&&"esriGeometryPolygon"!==s||(a.maxAllowableOffset=r),a},t.prototype.hasGeometryFilter=function(){return this.filters.some(function(e){return d.isSome(e)&&!!e.geometry})},r([h.property({readOnly:!0,dependsOn:["config","service","spatialReference"]})],t.prototype,"arcadeInfo",null),r([h.property()],t.prototype,"config",void 0),r([h.property({readOnly:!0,dependsOn:["config"]})],t.prototype,"featureReduction",null),r([h.property({readOnly:!0,dependsOn:["service"]})],t.prototype,"fieldsIndex",null),r([h.property()],t.prototype,"filters",void 0),r([h.property({readOnly:!0,dependsOn:["service"]})],t.prototype,"geometryInfo",null),r([h.property({readOnly:!0,dependsOn:["config"]})],t.prototype,"returnCentroid",null),r([h.property({readOnly:!0,dependsOn:["service","config"]})],t.prototype,"returnOutline",null),r([h.property({readOnly:!0,dependsOn:["config","availableFields"]})],t.prototype,"queryInfo",null),r([h.property({dependsOn:["config"],readOnly:!0})],t.prototype,"renderer",null),r([h.property()],t.prototype,"processor",void 0),r([h.property({readOnly:!0,dependsOn:["config"]})],t.prototype,"availableFields",null),r([h.property({constructOnly:!0})],t.prototype,"remoteClient",void 0),r([h.property({constructOnly:!0})],t.prototype,"service",void 0),r([h.property({dependsOn:["tileStore"]})],t.prototype,"spatialReference",null),r([h.property({constructOnly:!0})],t.prototype,"tileInfo",void 0),r([h.property({constructOnly:!0})],t.prototype,"tileStore",void 0),r([h.property({readOnly:!0})],t.prototype,"viewState",void 0),r([h.property({readOnly:!0,dependsOn:["viewState"]})],t.prototype,"viewParams",null),r([h.subclass("esri.views.2d.layers.features.controllers.BaseController")],t)}(h.declared(u.HandleOwner));t.default=I}.apply(null,i))||(e.exports=o)},625:function(e,t,r){var i,o;i=[r.dj.c(e.i),t,r(43),r(35),r(31),r(32),r(42),r(49),r(40),r(58),r(626),r(394),r(63),r(90),r(246),r(162),r(267),r(163),r(229),r(188),r(84)],void 0===(o=function(e,t,r,i,o,n,s,a,u,l,c,d,p,h,f,y,g,v,m,_,b){Object.defineProperty(t,"__esModule",{value:!0});var S=function(e){return u.andThen(e,function(e){return"cluster"!==e.type?null:i({},e,{clusterRadius:l.pt2px(e.clusterRadius/2)})})},x=function(e){function t(t,r,i,o,n){var s=this,a=new y.default([],[r,i]);return(s=e.call(this,a,o,null,t)||this).invalid=!1,s.canDelete=!1,s.geohashBoundsInfo=n,s}return r(t,e),Object.defineProperty(t.prototype,"count",{get:function(){return this.attributes.cluster_count},enumerable:!0,configurable:!0}),t.create=function(e,r,i,o,n,s,a){var u=new t(r,i,o,s,a);return u.localId=e.createLocalId(u.objectId,!0),u.tileLevel=n,u},t.prototype.update=function(e,t,r,i,o){return this.geometry.coords[0]=e,this.geometry.coords[1]=t,this.tileLevel=r,this.attributes=i,this.geohashBoundsInfo=o,this.referenceId=null,this.invalid=!1,this},t.prototype.toJSON=function(){return{objectId:this.objectId,referenceId:this.referenceId,attributes:i({},this.attributes,{clusterId:this.objectId}),geometry:{x:this.geometry.coords[0],y:this.geometry.coords[1]}}},t}(f.default),w=function(e){function t(t,r,i,o){var n=e.call(this,t)||this;return n._deferredDeletionQueue=[],n._invalidated=!1,n._aggregateFieldsHash=null,n._geohashLevel=0,n._aggregateValueRanges={},n._aggregateValueRangesChanged=!1,n._clusters=new Map,n._tiles=new Map,n._spatialReference=r,n._attributeStore=i,n._featureReduction=S(o),n._projectionSupportCheck=v.checkProjectionSupport(r,s.SpatialReference.WGS84),n}return r(t,e),t.prototype.update=function(e,t){return n(this,void 0,void 0,function(){var r,i,n,s,a,l,d=this;return o(this,function(o){switch(o.label){case 0:return r=this._featureReduction,i=u.andThen(t.featureReduction,S),n=t.aggregateFields.reduce(function(e,t){return e+JSON.stringify(t)},""),s=null===r&&t.featureReduction,a=n!==this._aggregateFieldsHash,l=s||a,[4,this._projectionSupportCheck];case 1:return o.sent(),this._featureReduction=i,this._aggregateFieldsHash=n,this._aggregateValueRanges={},this._invalidated=!0,u.isNone(i)?(this._tree=null,[2]):(u.isSome(r)&&r.clusterRadius!==i.clusterRadius&&this._clusters.forEach(function(e){return e.canDelete=!0}),l&&(this._tree=new c.GeohashTree(t.aggregateFields),this._unindexFeatures()),(l||e)&&this._reindexFeatures(),this._handleClusterUpdates(),this._tiles.forEach(function(e){return d._getClustersForTile(e,0,i.clusterRadius,null,!1)}),[2])}})})},t.prototype._unindexFeatures=function(){this._featuresById.forEach(function(e){e.geohashIndexed=!1})},t.prototype._reindexFeatures=function(){var e=this;this._featuresById.forEach(function(t){t.geohashX||t.geohashY||e._setGeohash(t),e._attributeStore.isVisible(t)?e._insertIntoIndex(t):e._removeFromIndex(t)})},t.prototype.onTileUpdate=function(e){var t=this,r=e.added,i=e.removed;if(r.length){var o=Math.max.apply(Math,r.map(function(e){return e.level}));this._setGeohashLevel(o),r.forEach(function(e){return t._tiles.set(e.key.id,e)})}if(!u.isNone(this._featureReduction)){var n=this._featureReduction.clusterRadius;i.forEach(function(e){t._tiles.delete(e.key.id),t._markTileClustersForDeletion(e,n)})}},t.prototype.sweepClusters=function(){var e=this;this._clusters.forEach(function(t,r){t.canDelete&&(e._attributeStore.freeLocalId(t.objectId),e._clusters.delete(r))});for(var t=0,r=this._deferredDeletionQueue;t<r.length;t++){var i=r[t];this._attributeStore.addLocalId(i)}this._deferredDeletionQueue=[]},t.prototype.executeTileQuery=function(t,r,i){return n(this,void 0,void 0,function(){var n,s,a;return o(this,function(o){switch(o.label){case 0:return u.isNone(this._featureReduction)?[2,e.prototype.executeTileQuery.call(this,t,r,i)]:[4,this._projectionSupportCheck];case 1:return o.sent(),this._handleClusterUpdates(),n=this._featureReduction.clusterRadius,s=this._getTransforms(t,r),a=this._getClustersForTile(t,i.pixelBuffer,n,s),this._aggregateValueRangesChanged&&(this.events.emit("valueRangesChanged",{valueRanges:this._aggregateValueRanges}),this._aggregateValueRangesChanged=!1),[2,a]}})})},t.prototype.getAggregate=function(e){var t=null;return this._clusters.forEach(function(r){r.localId===e&&(t=r.toJSON())}),t},t.prototype.getAggregateValueRanges=function(){return this._aggregateValueRanges},t.prototype._getClustersForTile=function(e,t,r,o,n){var l=this;void 0===n&&(n=!0),t=Math.max(t,50);for(var c=2*r,d=new Set,p=this._getGeohashLevel(e.key.level),f=Math.pow(2,e.key.level)*Math.ceil(b.TILE_SIZE/c),y=Math.ceil(t/c)+2,g=Math.ceil(b.TILE_SIZE/c)+2*y,S=e.key,x=S.row,w=S.col*b.TILE_SIZE,T=x*b.TILE_SIZE,I=Math.floor(w/c)-y,F=Math.floor(T/c)-y,j=I+g,C=F+g,O=new Array,R=e.tileInfoView.getLODInfoAt(e.key.level),M=I;M<=j;M++)for(var E=this,P=F;P<=C;P++)!function(t){var r,c,y=M;R.wrap&&(y=M<0?M+f:M%f);var g=R.wrap&&M<0,b=R.wrap&&M%f!==M,S=E._lookupCluster(R,e.key.level,y,t,p);if(u.isSome(S)){var x=u.andThen(o,function(e){return g?e.left:b?e.right:e.tile});if(n&&u.isNone(x))return"continue";if(!S.count)return"continue";if(n&&1===S.count){var w=S.geohashBoundsInfo,T=w.xLL,I=w.yLL,F=w.xTR,j=w.yTR,C=w.level,P=u.expect(E._tree).findSingleOccupancyNode(T,I,F,j,C),N=u.unwrap(P).getLngLatBounds(),G={x:N[0],y:N[1]},Q={x:N[2],y:N[3]},q=0,k=0,B=0,A=0;if(E._spatialReference.isWebMercator)q=(r=h.lngLatToXY(G.x,G.y))[0],k=r[1],B=(c=h.lngLatToXY(Q.x,Q.y))[0],A=c[1];else{var V=v.project(G,s.SpatialReference.WGS84,E._spatialReference),L=v.project(Q,s.SpatialReference.WGS84,E._spatialReference);if(!V||!L)return a("esri-2d-debug")&&console.debug("Failed to reproject known tree node"),"continue";q=V.x,k=V.y,B=L.x,A=L.y}var D=[q,k,B,A],z=null;if(E.forEachInBounds(D,function(e){l._attributeStore.isVisible(e)&&(z&&a("esri-2d-debug")&&console.debug("Expected to find only one feature, but found multiple"),z=e)}),!z)return a("esri-2d-debug")&&console.debug("Expected to find a feature, but found none"),"continue";var U=_.getGeometry(E.geometryInfo,z.geometry,0,u.expect(x)),H=i({},z.attributes,S.attributes);S.referenceId=z.localId,d.add(S.objectId),O.push(new m.Feature(H,S.localId,U))}else if(n){d.add(S.objectId);U=_.getGeometry(E.geometryInfo,S.geometry,0,u.expect(x));O.push(new m.Feature(S.attributes,S.localId,U))}}}(P);return{features:O,objectIds:d}},t.prototype._getGeohashLevel=function(e){return Math.min(Math.ceil(e/2+2),12)},t.prototype._setGeohashLevel=function(e){var t=this,r=this._geohashLevel,i=this._getGeohashLevel(e),o=2*(Math.floor(i/2)+1)-1,n=this._tree;this._geohashLevel=o,u.isNone(n)||(o>r?this._featuresById.forEach(function(e){e.geohashIndexed&&(n.insert(e,t._geohashLevel,r+1),e.geohashIndexed=!0)}):o<r&&n.dropLevels(this._geohashLevel))},t.prototype._insertIntoIndex=function(e){e.geohashIndexed||(this._invalidated=!0,e.geohashIndexed=!0,u.expect(this._tree).insert(e,this._geohashLevel))},t.prototype._removeFromIndex=function(e){e.geohashIndexed&&(this._invalidated=!0,u.expect(this._tree).remove(e,this._geohashLevel),e.geohashIndexed=!1)},t.prototype._handleClusterUpdates=function(){var e=this;this._invalidated&&this._clusters.size&&this._clusters.forEach(function(t){u.isSome(t)&&(t.invalid=t.invalid||e._invalidated)}),this._invalidated=!1},t.prototype._getTransforms=function(e,t){var r={originPosition:"upperLeft",scale:[e.resolution,e.resolution],translate:[e.bounds[0],e.bounds[3]]},o=p.getInfo(t);if(!o)return{tile:r,left:null,right:null};var n=o.valid,s=n[0],a=n[1];return{tile:r,left:i({},r,{translate:[a,e.bounds[3]]}),right:i({},r,{translate:[s-a+e.bounds[0],e.bounds[3]]})}},t.prototype._getClusterId=function(e,t,r){return(15&e)<<28|(16383&t)<<14|16383&r},t.prototype._markForDeletion=function(e,t,r){var i=this._getClusterId(e,t,r);if(this._clusters.has(i)){var o=this._clusters.get(i);u.isSome(o)?o.canDelete=!0:this._clusters.delete(i)}},t.prototype._getClusterBounds=function(e,t,r){if(u.isNone(this._featureReduction))return null;var i=this._featureReduction.clusterRadius,o=2*i,n=r%2?t*o:t*o+i,s=r*o,a=n/b.TILE_SIZE,l=s/b.TILE_SIZE,c=(n+o)/b.TILE_SIZE,d=(s-o)/b.TILE_SIZE;return[e.getXForColumn(a),e.getYForRow(l),e.getXForColumn(c),e.getYForRow(d)]},t.prototype._lookupCluster=function(e,t,r,o,n){var a,l;if(u.isNone(this._featureReduction)||u.isNone(this._tree))return null;var c=this._getClusterId(t,r,o),p=this._clusters.get(c);if(p&&u.isSome(p)&&!p.invalid&&!p.canDelete)return p;var f=this._getClusterBounds(e,r,o),y=f[0],g=f[1],m=f[2],_=f[3],b={x:y,y:g},S={x:m,y:_},w=0,T=0,I=0,F=0;if(this._spatialReference.isWebMercator)w=(a=h.xyToLngLat(b.x,b.y))[0],T=a[1],I=(l=h.xyToLngLat(S.x,S.y))[0],F=l[1];else{var j=v.project(b,this._spatialReference,s.SpatialReference.WGS84),C=v.project(S,this._spatialReference,s.SpatialReference.WGS84);if(!j||!C)return null;w=j.x,T=j.y,I=C.x,F=C.y}var O={geohashX:0,geohashY:0},R={geohashX:0,geohashY:0};d.setGeohashXY(O,T,w,n),d.setGeohashXY(R,F,I,n);var M=O.geohashX,E=O.geohashY,P=R.geohashX,N=R.geohashY,G={xLL:M,yLL:E,xTR:P,yTR:N,level:n},Q=this._tree.getRegionStatistics(M,E,P,N,n),q=Q.count,k=Q.xTotal,B=Q.yTotal,A=q?k/q:0,V=q?B/q:0;if(u.isSome(p)&&p.canDelete){var L=this._attributeStore.removeLocalId(p.objectId);this._deferredDeletionQueue.push(L)}var D=u.isSome(p)&&!p.canDelete&&p.invalid,z=i({cluster_count:q},Q.attributes),U=this._attributeStore,H=D?p.update(A,V,t,z,G):x.create(U,c,A,V,t,z,G);return 0===q&&(H.geometry.coords[0]=(y+m)/2,H.geometry.coords[1]=(g+_)/2),this._attributeStore.setAttributeData(H.localId,H,this.geometryInfo,null),this._clusters.set(c,H),this._updateAggregateValueRangeForCluster(H,H.tileLevel),H},t.prototype._updateAggregateValueRangeForCluster=function(e,t){var r=this._aggregateValueRanges[t]||{minValue:1/0,maxValue:0},i=r.minValue,o=r.maxValue;r.minValue=Math.min(i,e.count),r.maxValue=Math.max(o,e.count),this._aggregateValueRanges[t]=r,i===r.minValue&&o===r.maxValue||(this._aggregateValueRangesChanged=!0)},t.prototype._markTileClustersForDeletion=function(e,t){for(var r=2*t,i=Math.ceil(b.TILE_SIZE/r),o=e.key,n=o.row,s=o.col*b.TILE_SIZE,a=n*b.TILE_SIZE,u=Math.floor(s/r),l=Math.floor(a/r),c=u;c<u+i;c++)for(var d=l;d<l+i;d++)this._markForDeletion(e.key.level,c,d)},t.prototype._setGeohash=function(e){var t=e.geometry;if(t&&t.coords.length){var r={x:t.coords[0],y:t.coords[1]},i=v.project(r,this._spatialReference,s.SpatialReference.WGS84);if(!i)return void(a("esri-2d-debug")&&console.debug("Tried to project feature geometry, but got back `null`"));d.setGeohashXY(e,i.y,i.x,12)}},t.prototype._add=function(t){var r=this._featuresById.get(t.objectId);e.prototype._add.call(this,t),u.isSome(this._featureReduction)&&u.isSome(this._tree)&&(r?(t.geohashIndexed=r.geohashIndexed,t.geohashX=r.geohashX,t.geohashY=r.geohashY):this._setGeohash(t),!t.geohashIndexed&&this._attributeStore.isVisible(t)&&this._insertIntoIndex(t))},t.prototype._remove=function(t){return u.isSome(this._featureReduction)&&u.isSome(this._tree)&&this._removeFromIndex(t),e.prototype._remove.call(this,t)},t}(g.default);t.ClusterStore=w}.apply(null,i))||(e.exports=o)},626:function(e,t,r){var i,o;i=[r.dj.c(e.i),t,r(430),r(40),r(394)],void 0===(o=function(e,t,r,i,o){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e){this._pool=new r.default(8024),this._nodes=0,this._root=new s(0,0,0),this._fields=e}return e.prototype._acquire=function(e,t,r){var o=this._pool.dequeue();return this._nodes++,i.isSome(o)?o.realloc(e,t,r):new s(e,t,r)},e.prototype._release=function(e){this._nodes--,this._pool.enqueue(e)},Object.defineProperty(e.prototype,"count",{get:function(){return this._root.count},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"size",{get:function(){return this._nodes},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"poolSize",{get:function(){return this._pool.size},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"depth",{get:function(){var e=0;return this._forEachNode(function(t){return e=Math.max(e,t.depth)}),e},enumerable:!0,configurable:!0}),e.prototype.dropLevels=function(e){var t=this;this._forEachNode(function(r){if(r.depth>=e)for(var i=0;i<r.children.length;i++){var o=r.children[i];r.children[i]=null,o&&t._release(o)}})},e.prototype.insert=function(e,t,r){void 0===r&&(r=0);for(var i=this._root,o=0,n=0,s=0;null!==i;){if(i.depth>=r&&(i.count+=1,i.xTotal+=e.geometry.coords[0],i.yTotal+=e.geometry.coords[1],i.xGeohashTotal+=e.geohashX,i.yGeohashTotal+=e.geohashY,this._updateStatistics(e,i,1)),o>=t)return;var a=Math.ceil((o+1)/2),u=Math.floor((o+1)/2),l=1-o%2,c=30-(3*a+2*u),d=30-(2*a+3*u),p=7*l+3*(1-l)<<c,h=3*l+7*(1-l)<<d,f=8*l+4*(1-l),y=(e.geohashX&p)>>c,g=(e.geohashY&h)>>d,v=y+g*f;n=n<<3*l+2*(1-l)|y,s=s<<2*l+3*(1-l)|g,null==i.children[v]&&(i.children[v]=this._acquire(n,s,o+1)),o+=1,i=i.children[v]}},e.prototype.remove=function(e,t){for(var r=this._root,i=0;null!==r;){if(r.count-=1,r.xTotal-=e.geometry.coords[0],r.yTotal-=e.geometry.coords[1],r.xGeohashTotal-=e.geohashX,r.yGeohashTotal-=e.geohashY,this._updateStatistics(e,r,-1),i>=t)return;var o=Math.ceil((i+1)/2),n=Math.floor((i+1)/2),s=1-i%2,a=30-(3*o+2*n),u=30-(2*o+3*n),l=7*s+3*(1-s)<<a,c=3*s+7*(1-s)<<u,d=8*s+4*(1-s),p=((e.geohashX&l)>>a)+((e.geohashY&c)>>u)*d,h=r.children[p];1===h.count&&(this._release(h),r.children[p]=null),i+=1,r=h}},e.prototype.find=function(e,t,r){return this._root.find(e,t,r,0,0,0)},e.prototype.findSingleOccupancyNode=function(e,t,r,i,o){for(var n=this._root;null!==n;){var s=n.depth,a=n.xNode,u=n.yNode,l=1-s%2,c=n.xGeohashTotal/n.count,d=n.yGeohashTotal/n.count;if(1===n.count&&e<c&&c<=r&&t<d&&d<=i)return n;if(s>=o)n=n.next;else{for(var p=Math.ceil((s+1)/2),h=Math.floor((s+1)/2),f=30-(3*p+2*h),y=30-(2*p+3*h),g=~((1<<f)-1),v=~((1<<y)-1),m=(e&g)>>f,_=(t&v)>>y,b=(r&g)>>f,S=(i&v)>>y,x=a<<3*l+2*(1-l),w=u<<2*l+3*(1-l),T=x+8*l+4*(1-l),I=w+4*l+8*(1-l),F=Math.max(x,m),j=Math.max(w,_),C=Math.min(T,b),O=Math.min(I,S),R=null,M=null,E=j;E<=O;E++)for(var P=F;P<=C;P++){var N=P-x+(E-w)*(8*l+4*(1-l)),G=n.children[N];G&&(R||((R=G).next=n.next),M&&(M.next=G),M=G,G.next=n.next)}n=R||n.next}}return null},e.prototype.getRegionStatistics=function(e,t,r,i,o){for(var n=this._root,s=0,a=0,u=0,l={};null!==n;){var c=n.depth,d=n.xNode,p=n.yNode;if(c>=o){var h=n.xGeohashTotal/n.count,f=n.yGeohashTotal/n.count;e<h&&h<=r&&t<f&&f<=i&&(s+=n.count,a+=n.xTotal,u+=n.yTotal,this._aggregateStatistics(l,n.statistics)),n=n.next}else{for(var y=Math.ceil((c+1)/2),g=Math.floor((c+1)/2),v=1-c%2,m=30-(3*y+2*g),_=30-(2*y+3*g),b=~((1<<m)-1),S=~((1<<_)-1),x=(e&b)>>m,w=(t&S)>>_,T=(r&b)>>m,I=(i&S)>>_,F=d<<3*v+2*(1-v),j=p<<2*v+3*(1-v),C=F+8*v+4*(1-v),O=j+4*v+8*(1-v),R=Math.max(F,x),M=Math.max(j,w),E=Math.min(C,T),P=Math.min(O,I),N=null,G=null,Q=M;Q<=P;Q++)for(var q=R;q<=E;q++){var k=q-F+(Q-j)*(8*v+4*(1-v)),B=n.children[k];if(B){if(Q!==M&&Q!==P&&q!==R&&q!==E){h=B.xGeohashTotal/B.count,f=B.yGeohashTotal/B.count;e<h&&h<=r&&t<f&&f<=i&&(s+=B.count,a+=B.xTotal,u+=B.yTotal,this._aggregateStatistics(l,B.statistics));continue}N||((N=B).next=n.next),G&&(G.next=B),G=B,B.next=n.next}}n=N||n.next}}return{count:s,attributes:this._normalizeStatistics(l,s),xTotal:a,yTotal:u}},e.prototype._forEachNode=function(e){for(var t=this._root;null!==t;){var r=this._linkChildren(t)||t.next;e(t),t=r}},e.prototype._linkChildren=function(e){for(var t=null,r=null,i=0;i<=e.children.length;i++){var o=e.children[i];o&&(t||((t=o).next=e.next),r&&(r.next=o),r=o,o.next=e.next)}return t},e.prototype._updateStatistics=function(e,t,r){for(var i=0,o=this._fields;i<o.length;i++){var n=o[i],s=n.name,a=n.outStatistic.onStatisticField,u=e.attributes[a];switch(n.outStatistic.statisticType){case"norm":t.statistics[s]||(t.statistics[s]={});var l=n.outStatistic.onStatisticNormalizationField,c=e.attributes[l],d=t.statistics[s].onStatisticField||0,p=t.statistics[s].onStatisticNormalizationField||0;null==u||isNaN(u)||null==c||0===c||isNaN(c)||(t.statistics[s].onStatisticField=d+r*u,t.statistics[s].onStatisticNormalizationField=p+r*c);break;case"avg":t.statistics[s]||(t.statistics[s]={value:0,nanCount:0});var h=t.statistics[s].value,f=t.statistics[s].nanCount;null==u||isNaN(u)?t.statistics[s].nanCount=f+r:t.statistics[s].value=h+r*u;break;case"avg_angle":t.statistics[s]||(t.statistics[s]={x:0,y:0,nanCount:0});var y=t.statistics[s].x,g=t.statistics[s].y,v=(f=t.statistics[s].nanCount,Math.PI/180);null==u||isNaN(u)?t.statistics[s].nanCount=f+r:(t.statistics[s].x=y+r*Math.cos(u*v),t.statistics[s].y=g+r*Math.sin(u*v));break;case"mode":t.statistics[s]||(t.statistics[s]={});h=t.statistics[s][u]||0;t.statistics[s][u]=h+r}}},e.prototype._aggregateStatistics=function(e,t){for(var r=0,i=this._fields;r<i.length;r++){var o=i[r],n=o.name;switch(o.outStatistic.statisticType){case"avg":case"avg_angle":case"mode":case"norm":for(var s in e[n]||(e[n]={}),t[n]){var a=e[n][s]||0;e[n][s]=a+t[n][s]}}}},e.prototype._normalizeStatistics=function(e,t){for(var r={},i=0,o=this._fields;i<o.length;i++){var n=o[i],s=n.name;switch(n.outStatistic.statisticType){case"norm":var a=e[s];if(t&&null==a.onStatisticNormalizationField)break;if(t&&a.onStatisticNormalizationField){r[s]=a.onStatisticField/a.onStatisticNormalizationField;break}r[s]=0;break;case"avg":if(!t)break;var u=e[s],l=u.value;if(!(t-(c=u.nanCount)))break;r[s]=l/(t-c);break;case"avg_angle":if(!t)break;var c,d=e[s],p=d.x,h=d.y;if(!(t-(c=d.nanCount)))break;var f=p/(t-c),y=h/(t-c),g=180/Math.PI,v=Math.atan2(y,f)*g;r[s]=v;break;case"mode":var m=e[s],_=0,b=null;for(var S in m){var x=m[S];x>_&&(_=x,b=S)}r[s]="null"===b?null:b}}return r},e}();t.GeohashTree=n;var s=function(){function e(e,t,r){this.count=0,this.xTotal=0,this.yTotal=0,this.statistics={},this.next=null,this.depth=0,this.xNode=0,this.yNode=0,this.xGeohashTotal=0,this.yGeohashTotal=0,this.children=new Array(32);for(var i=0;i<this.children.length;i++)this.children[i]=null;this.xNode=e,this.yNode=t,this.depth=r}return e.prototype.realloc=function(e,t,r){for(var i=0;i<this.children.length;i++)this.children[i]=null;return this.xNode=e,this.yNode=t,this.depth=r,this.next=null,this.xGeohashTotal=0,this.yGeohashTotal=0,this.xTotal=0,this.yTotal=0,this.count=0,this.statistics={},this},e.prototype.getLngLatBounds=function(){var e=this.depth,t=Math.ceil(e/2),r=Math.floor(e/2),i=30-(3*t+2*r),n=30-(2*t+3*r),s=this.xNode<<i,a=this.yNode<<n;return o.decodeGeohashXY({geohashX:s,geohashY:a},this.depth)},e.prototype.find=function(e,t,r,i,o,n){if(i>=r)return this;var s=1-i%2,a=3*s+2*(1-s),u=2*s+3*(1-s),l=30-o-a,c=30-n-u,d=((e&7*s+3*(1-s)<<l)>>l)+((t&3*s+7*(1-s)<<c)>>c)*(8*s+4*(1-s)),p=this.children[d];return null==p?null:p.find(e,t,r,i+1,o+a,n+u)},e}()}.apply(null,i))||(e.exports=o)},627:function(e,t,r){var i,o;i=[r.dj.c(e.i),t,r(31),r(32),r(34),r(58),r(98),r(368)],void 0===(o=function(e,t,r,i,o,n,s,a){function u(e,t){return null==e?t:e}function l(e,t){return null==e.outline?t:u(e.outline.width,t)}function c(e,t){return i(this,void 0,void 0,function(){var i,o,n,d,h,f,_,b,S,x,w;return r(this,function(r){switch(r.label){case 0:return"simple-marker"===e.type?(i=Math.max(u(e.size,12),t),[2,p(e)+i*y]):"picture-marker"===e.type?(o=Math.max(u(e.height,12),t),n=u(e.width,12)*(o/u(e.height,12)),d=n/2,h=o/2,[2,p(e)+Math.sqrt(d*d+h*h)]):"text"===e.type?(a.getTextSymbolEstimatedSize(g,e,s.definitions.AVERAGE_GLYPH_MOSAIC_ITEM),f=g[2]*(u(e.horizontalAlignment,"top")in v?1:.5),_=g[3]*(u(e.horizontalAlignment,"center")in m?1:.5),b=function(e,t){return null==e.font?t:u(e.font.size,t)}(e,9),S=Math.max(b,t)/b,[2,p(e)+Math.sqrt(f*f+_*_)*S]):"simple-line"===e.type?[2,Math.max(u(e.width,.75),t)/2]:"simple-fill"===e.type||"picture-fill"===e.type?[2,Math.max(l(e,0),t)/2]:"cim"===e.type?(x=s.CIMSymbolHelper.getEnvelope(e.data))?[2,Math.sqrt(x.width*x.width+x.height*x.height)]:[2,0]:"web-style"!==e.type?[3,2]:(w=c,[4,e.fetchCIMSymbol()]);case 1:return[2,w.apply(void 0,[r.sent(),t])];case 2:return[2,0]}})})}function d(e,t){return i(this,void 0,void 0,function(){var i,o;return r(this,function(r){switch(r.label){case 0:return function(e){return e.type in f}(e)?(o=(i=Math).min,[4,c(e,t)]):[2,0];case 1:return[2,o.apply(i,[r.sent(),75])]}})})}function p(e){var t=u(e.xoffset,0),r=u(e.yoffset,0);return Math.sqrt(t*t+r*r)}function h(e,t){return Math.max(e,t)}Object.defineProperty(t,"__esModule",{value:!0});var f={"simple-marker":1,"picture-marker":1,text:1,"simple-line":1,"simple-fill":1,"picture-fill":1,cim:1,"web-style":1},y=.707;t.computePxBuffer=function(e,t){return i(this,void 0,void 0,function(){var i,s,a,u,l,c,p;return r(this,function(r){switch(r.label){case 0:if("heatmap"===e.type)return[2,Math.round(3*e.blurRadius)];if("dot-density"===e.type)return[2,0];if("dictionary"===e.type)return"esriGeometryPoint"===t||"esriGeometryMultipoint"===t?[2,100]:[2,50];for(i=e.getSymbols(),s=function(e){if(!("visualVariables"in e))return 0;if(!e.hasVisualVariables("size"))return 0;var t=e.getVisualVariablesForType("size");if(!t[0])return 0;var r=t[0];return"stops"===r.transformationType?r.stops.map(function(e){return e.size}).reduce(h,0):"clamped-linear"===r.transformationType?"number"==typeof r.maxSize?r.maxSize:r.maxSize.stops.map(function(e){return e.size}).reduce(h,0):"real-world-size"===r.transformationType?30:void 0}(e),a=[],u=0,l=i;u<l.length;u++)c=l[u],a.push(d(c,s));return[4,o.all(a)];case 1:return p=r.sent(),[2,n.pt2px(p.reduce(h,0))]}})})};var g=[0,0,0,0],v={left:1,right:1},m={top:1,bottom:1,baseline:1}}.apply(null,i))||(e.exports=o)},74:function(e,t,r){var i,o;i=[r.dj.c(e.i),t,r(29),r(28),r(42),r(42),r(71),r(97),r(41),r(33),r(38),r(30),r(48),r(46),r(80),r(85),r(93)],void 0===(o=function(e,t,r,i,o,n,s,a,u,l,c,d,p,h,f,y,g){var v=new u.default({esriSpatialRelIntersects:"intersects",esriSpatialRelContains:"contains",esriSpatialRelCrosses:"crosses",esriSpatialRelDisjoint:"disjoint",esriSpatialRelEnvelopeIntersects:"envelope-intersects",esriSpatialRelIndexIntersects:"index-intersects",esriSpatialRelOverlaps:"overlaps",esriSpatialRelTouches:"touches",esriSpatialRelWithin:"within",esriSpatialRelRelation:"relation"}),m=new u.default({esriSRUnit_Meter:"meters",esriSRUnit_Kilometer:"kilometers",esriSRUnit_Foot:"feet",esriSRUnit_StatuteMile:"miles",esriSRUnit_NauticalMile:"nautical-miles",esriSRUnit_USNauticalMile:"us-nautical-miles"});return function(e){function t(t){var r=e.call(this,t)||this;return r.cacheHint=!1,r.datumTransformation=null,r.distance=void 0,r.gdbVersion=null,r.geometry=null,r.geometryPrecision=void 0,r.groupByFieldsForStatistics=null,r.having=null,r.historicMoment=null,r.maxAllowableOffset=void 0,r.maxRecordCountFactor=1,r.multipatchOption=null,r.num=void 0,r.objectIds=null,r.orderByFields=null,r.outFields=null,r.outSpatialReference=null,r.outStatistics=null,r.parameterValues=null,r.pixelSize=null,r.quantizationParameters=null,r.rangeValues=null,r.relationParameter=null,r.resultType=null,r.returnCentroid=!1,r.returnDistinctValues=!1,r.returnExceededLimitFeatures=!0,r.returnGeometry=!1,r.returnQueryGeometry=!1,r.returnM=void 0,r.returnZ=void 0,r.source=null,r.spatialRelationship="intersects",r.start=void 0,r.sqlFormat=null,r.text=null,r.timeExtent=null,r.units=null,r.where=null,r}var u;return r(t,e),u=t,t.from=function(e){return p.ensureClass(u,e)},t.prototype.castDatumTransformation=function(e){return"number"==typeof e||"object"==typeof e?e:null},t.prototype.writeHistoricMoment=function(e,t){t.historicMoment=e&&e.getTime()},t.prototype.writeParameterValues=function(e,t){if(e){var r={};for(var i in e){var o=e[i];Array.isArray(o)?r[i]=o.map(function(e){return e instanceof Date?e.getTime():e}):o instanceof Date?r[i]=o.getTime():r[i]=o}t.parameterValues=r}},t.prototype.writeStart=function(e,t){t.resultOffset=this.start,t.resultRecordCount=this.num||10,t.where="1=1"},t.prototype.writeWhere=function(e,t){t.where=e||"1=1"},t.prototype.clone=function(){return new u(c.clone({cacheHint:this.cacheHint,datumTransformation:this.datumTransformation,distance:this.distance,gdbVersion:this.gdbVersion,geometry:this.geometry,geometryPrecision:this.geometryPrecision,groupByFieldsForStatistics:this.groupByFieldsForStatistics,having:this.having,historicMoment:this.historicMoment?new Date(this.historicMoment.getTime()):null,maxAllowableOffset:this.maxAllowableOffset,maxRecordCountFactor:this.maxRecordCountFactor,multipatchOption:this.multipatchOption,num:this.num,objectIds:this.objectIds,orderByFields:this.orderByFields,outFields:this.outFields,outSpatialReference:this.outSpatialReference,outStatistics:this.outStatistics,parameterValues:this.parameterValues,pixelSize:this.pixelSize,quantizationParameters:this.quantizationParameters,rangeValues:this.rangeValues,relationParameter:this.relationParameter,resultType:this.resultType,returnDistinctValues:this.returnDistinctValues,returnGeometry:this.returnGeometry,returnCentroid:this.returnCentroid,returnExceededLimitFeatures:this.returnExceededLimitFeatures,returnQueryGeometry:this.returnQueryGeometry,returnM:this.returnM,returnZ:this.returnZ,source:this.source,spatialRelationship:this.spatialRelationship,start:this.start,sqlFormat:this.sqlFormat,text:this.text,timeExtent:this.timeExtent,units:this.units,where:this.where}))},t.MAX_MAX_RECORD_COUNT_FACTOR=5,i([d.property({type:Boolean,json:{write:!0,default:!1}})],t.prototype,"cacheHint",void 0),i([d.property({json:{write:!0}})],t.prototype,"datumTransformation",void 0),i([d.cast("datumTransformation")],t.prototype,"castDatumTransformation",null),i([d.property({type:Number,json:{write:{overridePolicy:function(e){return{enabled:e>0}}}}})],t.prototype,"distance",void 0),i([d.property({type:String,json:{write:!0}})],t.prototype,"gdbVersion",void 0),i([d.property({types:n.geometryTypes,json:{read:h.fromJSON,write:!0}})],t.prototype,"geometry",void 0),i([d.property({type:Number,json:{write:!0}})],t.prototype,"geometryPrecision",void 0),i([d.property({type:[String],json:{write:!0}})],t.prototype,"groupByFieldsForStatistics",void 0),i([d.property({type:String,json:{write:!0}})],t.prototype,"having",void 0),i([d.property({type:Date})],t.prototype,"historicMoment",void 0),i([d.writer("historicMoment")],t.prototype,"writeHistoricMoment",null),i([d.property({type:Number,json:{write:!0}})],t.prototype,"maxAllowableOffset",void 0),i([d.property({type:Number,cast:function(e){return e<1?1:e>u.MAX_MAX_RECORD_COUNT_FACTOR?u.MAX_MAX_RECORD_COUNT_FACTOR:e},json:{write:{overridePolicy:function(e){return{enabled:e>1}}}}})],t.prototype,"maxRecordCountFactor",void 0),i([d.property({type:String,json:{write:!0}})],t.prototype,"multipatchOption",void 0),i([d.property({type:Number,json:{read:{source:"resultRecordCount"}}})],t.prototype,"num",void 0),i([d.property({type:[Number],json:{write:!0}})],t.prototype,"objectIds",void 0),i([d.property({type:[String],json:{write:!0}})],t.prototype,"orderByFields",void 0),i([d.property({type:[String],json:{write:!0}})],t.prototype,"outFields",void 0),i([d.property({type:o.SpatialReference,json:{read:{source:"outSR"},write:{target:"outSR"}}})],t.prototype,"outSpatialReference",void 0),i([d.property({type:[g],json:{write:!0}})],t.prototype,"outStatistics",void 0),i([d.property({json:{write:!0}})],t.prototype,"parameterValues",void 0),i([d.writer("parameterValues")],t.prototype,"writeParameterValues",null),i([d.property({types:s.symbolTypes,json:{read:f.read,write:!0}})],t.prototype,"pixelSize",void 0),i([d.property({type:y.default,json:{write:!0}})],t.prototype,"quantizationParameters",void 0),i([d.property({type:[Object],json:{write:!0}})],t.prototype,"rangeValues",void 0),i([d.property({type:String,json:{read:{source:"relationParam"},write:{target:"relationParam",overridePolicy:function(){return{enabled:"relation"===this.spatialRelationship}}}}})],t.prototype,"relationParameter",void 0),i([d.property({type:String,json:{write:!0}})],t.prototype,"resultType",void 0),i([d.property({type:Boolean,json:{write:{overridePolicy:function(e){return{enabled:e}}}}})],t.prototype,"returnCentroid",void 0),i([d.property({type:Boolean,json:{write:{overridePolicy:function(e){return{enabled:e}}}}})],t.prototype,"returnDistinctValues",void 0),i([d.property({type:Boolean,json:{write:{overridePolicy:function(e){return{enabled:!e}}}}})],t.prototype,"returnExceededLimitFeatures",void 0),i([d.property({type:Boolean,json:{write:!0}})],t.prototype,"returnGeometry",void 0),i([d.property({type:Boolean,json:{write:{overridePolicy:function(e){return{enabled:e}}}}})],t.prototype,"returnQueryGeometry",void 0),i([d.property({type:Boolean,json:{write:{overridePolicy:function(e){return{enabled:e}}}}})],t.prototype,"returnM",void 0),i([d.property({type:Boolean,json:{write:{overridePolicy:function(e){return{enabled:e}}}}})],t.prototype,"returnZ",void 0),i([d.property({json:{write:!0}})],t.prototype,"source",void 0),i([d.property({type:String,json:{read:{source:"spatialRel",reader:v.read},write:{target:"spatialRel",writer:v.write}}})],t.prototype,"spatialRelationship",void 0),i([d.property({type:Number,json:{read:{source:"resultOffset"}}})],t.prototype,"start",void 0),i([d.writer("start"),d.writer("num")],t.prototype,"writeStart",null),i([d.property({type:String,json:{write:!0}})],t.prototype,"sqlFormat",void 0),i([d.property({type:String,json:{write:!0}})],t.prototype,"text",void 0),i([d.property({type:a,json:{write:!0}})],t.prototype,"timeExtent",void 0),i([d.property({type:String,json:{read:m.read,write:{writer:m.write,overridePolicy:function(e){return{enabled:e&&this.distance>0}}}}})],t.prototype,"units",void 0),i([d.property({type:String,json:{write:{overridePolicy:function(e){return{enabled:null!=e||this.start>0}}}}})],t.prototype,"where",void 0),i([d.writer("where")],t.prototype,"writeWhere",null),u=i([d.subclass("esri.tasks.support.Query")],t)}(d.declared(l.JSONSupport))}.apply(null,i))||(e.exports=o)},78:function(e,t,r){var i,o;i=[r.dj.c(e.i),t,r(29),r(28),r(41),r(33),r(30),r(48),r(169),r(170)],void 0===(o=function(e,t,r,i,o,n,s,a,u,l){var c=new o.default({binary:"binary",coordinate:"coordinate",countOrAmount:"count-or-amount",dateAndTime:"date-and-time",description:"description",locationOrPlaceName:"location-or-place-name",measurement:"measurement",nameOrTitle:"name-or-title",none:"none",orderedOrRanked:"ordered-or-ranked",percentageOrRatio:"percentage-or-ratio",typeOrCategory:"type-or-category",uniqueIdentifier:"unique-identifier"});return function(e){function t(t){var r=e.call(this,t)||this;return r.alias=null,r.defaultValue=void 0,r.description=null,r.domain=null,r.editable=!0,r.length=-1,r.name=null,r.nullable=!0,r.type=null,r.valueType=null,r}var o;return r(t,e),o=t,t.prototype.readDescription=function(e,t){var r,i=t.description;try{r=JSON.parse(i)}catch(e){}return r?r.value:null},t.prototype.readValueType=function(e,t){var r,i=t.description;try{r=JSON.parse(i)}catch(e){}return r?c.fromJSON(r.fieldValueType):null},t.prototype.clone=function(){return new o({alias:this.alias,defaultValue:this.defaultValue,description:this.description,domain:this.domain&&this.domain.clone()||null,editable:this.editable,length:this.length,name:this.name,nullable:this.nullable,type:this.type,valueType:this.valueType})},i([s.property({type:String,json:{write:!0}})],t.prototype,"alias",void 0),i([s.property({type:[String,Number],json:{write:{allowNull:!0}}})],t.prototype,"defaultValue",void 0),i([s.property()],t.prototype,"description",void 0),i([s.reader("description")],t.prototype,"readDescription",null),i([s.property({types:u.types,json:{read:{reader:u.fromJSON},write:!0}})],t.prototype,"domain",void 0),i([s.property({type:Boolean,json:{write:!0}})],t.prototype,"editable",void 0),i([s.property({type:a.Integer,json:{write:!0}})],t.prototype,"length",void 0),i([s.property({type:String,json:{write:!0}})],t.prototype,"name",void 0),i([s.property({type:Boolean,json:{write:!0}})],t.prototype,"nullable",void 0),i([s.enumeration.serializable()(l.kebabDict)],t.prototype,"type",void 0),i([s.property()],t.prototype,"valueType",void 0),i([s.reader("valueType",["description"])],t.prototype,"readValueType",null),o=i([s.subclass("esri.layers.support.Field")],t)}(s.declared(n.JSONSupport))}.apply(null,i))||(e.exports=o)},93:function(e,t,r){var i,o;i=[r.dj.c(e.i),t,r(29),r(28),r(33),r(30)],void 0===(o=function(e,t,r,i,o,n){return function(e){function t(t){var r=e.call(this,t)||this;return r.maxPointCount=void 0,r.maxRecordCount=void 0,r.maxVertexCount=void 0,r.onStatisticField=null,r.outStatisticFieldName=null,r.statisticType=null,r}var o;return r(t,e),o=t,t.prototype.clone=function(){return new o({maxPointCount:this.maxPointCount,maxRecordCount:this.maxRecordCount,maxVertexCount:this.maxVertexCount,onStatisticField:this.onStatisticField,outStatisticFieldName:this.outStatisticFieldName,statisticType:this.statisticType})},i([n.property({type:Number,json:{write:!0}})],t.prototype,"maxPointCount",void 0),i([n.property({type:Number,json:{write:!0}})],t.prototype,"maxRecordCount",void 0),i([n.property({type:Number,json:{write:!0}})],t.prototype,"maxVertexCount",void 0),i([n.property({type:String,json:{write:!0}})],t.prototype,"onStatisticField",void 0),i([n.property({type:String,json:{write:!0}})],t.prototype,"outStatisticFieldName",void 0),i([n.property({type:String,json:{write:!0}})],t.prototype,"statisticType",void 0),o=i([n.subclass("esri.tasks.support.StatisticDefinition")],t)}(n.declared(o.JSONSupport))}.apply(null,i))||(e.exports=o)}}]);